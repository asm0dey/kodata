
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../kandy/">
      
      
        <link rel="next" href="../kravis/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Kotlin∇ - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Kotlin∇ - My Docs" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="./assets/images/social/kotlingrad/README.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Kotlin∇ - My Docs" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="./assets/images/social/kotlingrad/README.png" >
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kotlin-type-safe-symbolic-differentiation-for-the-jvm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kotlin∇
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../dataforge-core/" class="md-tabs__link">
          
  
  Data Wrangling

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../kotlindl/" class="md-tabs__link">
          
  
  ML

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="./" class="md-tabs__link">
          
  
  Math

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../kaliningraph/" class="md-tabs__link">
          
  
  Plots

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../kalasim/" class="md-tabs__link">
          
  
  Other

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Data Wrangling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Data Wrangling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataforge-core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dataforge-core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../controls-kt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controls.kt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kotlin-spark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kotlin for Apache® Spark™
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kotlin DataFrame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tables-kt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tables.kt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ML
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ML
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kotlindl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kotlindl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../londogard-nlp-toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    londogard-nlp-toolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../summarize-kt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    summarize-kt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text-gen-kt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    text-gen-kt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smile-nlp-kt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smile-nlp-kt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Math
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Kotlin∇
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Kotlin∇
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gradle" class="md-nav__link">
    <span class="md-ellipsis">
      Gradle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maven" class="md-nav__link">
    <span class="md-ellipsis">
      Maven
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notation" class="md-nav__link">
    <span class="md-ellipsis">
      Notation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-rank-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Higher-Rank Derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Higher-order derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape-safety" class="md-nav__link">
    <span class="md-ellipsis">
      Shape safety
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-capture" class="md-nav__link">
    <span class="md-ellipsis">
      Variable capture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualization tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataflow-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      Dataflow graphs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loss-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Loss curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how" class="md-nav__link">
    <span class="md-ellipsis">
      How?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-overloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator overloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-class-functions" class="md-nav__link">
    <span class="md-ellipsis">
      First-class functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-stage-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-stage programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algebraic-data-types" class="md-nav__link">
    <span class="md-ellipsis">
      Algebraic data types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extension-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Extension functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple dispatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape-safe-tensor-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Shape-safe tensor operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-delegation" class="md-nav__link">
    <span class="md-ellipsis">
      Property delegation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental ideas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental ideas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#church-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Church encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Type classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Type arithmetic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grammar" class="md-nav__link">
    <span class="md-ellipsis">
      Grammar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uml-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      UML Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic differentiation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentiable-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Differentiable programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculus" class="md-nav__link">
    <span class="md-ellipsis">
      Calculus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computer-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      Computer algebra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symbolic-mathematics" class="md-nav__link">
    <span class="md-ellipsis">
      Symbolic mathematics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neural-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Neural networks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Type systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-specific-languages" class="md-nav__link">
    <span class="md-ellipsis">
      Domain-specific languages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automated testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ad-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      AD libraries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-thanks" class="md-nav__link">
    <span class="md-ellipsis">
      Special thanks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kmath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kmath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multik/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multik
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Plots
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Plots
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kaliningraph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kaliningraph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kandy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kandy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Kotlin∇
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Kotlin∇
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gradle" class="md-nav__link">
    <span class="md-ellipsis">
      Gradle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maven" class="md-nav__link">
    <span class="md-ellipsis">
      Maven
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notation" class="md-nav__link">
    <span class="md-ellipsis">
      Notation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-rank-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Higher-Rank Derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Higher-order derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape-safety" class="md-nav__link">
    <span class="md-ellipsis">
      Shape safety
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-capture" class="md-nav__link">
    <span class="md-ellipsis">
      Variable capture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualization tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataflow-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      Dataflow graphs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loss-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Loss curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how" class="md-nav__link">
    <span class="md-ellipsis">
      How?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-overloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator overloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-class-functions" class="md-nav__link">
    <span class="md-ellipsis">
      First-class functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-stage-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-stage programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algebraic-data-types" class="md-nav__link">
    <span class="md-ellipsis">
      Algebraic data types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extension-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Extension functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple dispatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape-safe-tensor-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Shape-safe tensor operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-delegation" class="md-nav__link">
    <span class="md-ellipsis">
      Property delegation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental ideas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental ideas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#church-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Church encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Type classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Type arithmetic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grammar" class="md-nav__link">
    <span class="md-ellipsis">
      Grammar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uml-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      UML Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic differentiation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentiable-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Differentiable programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculus" class="md-nav__link">
    <span class="md-ellipsis">
      Calculus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computer-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      Computer algebra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symbolic-mathematics" class="md-nav__link">
    <span class="md-ellipsis">
      Symbolic mathematics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neural-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Neural networks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Type systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-specific-languages" class="md-nav__link">
    <span class="md-ellipsis">
      Domain-specific languages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automated testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ad-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      AD libraries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-thanks" class="md-nav__link">
    <span class="md-ellipsis">
      Special thanks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kravis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kravis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lets-plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lets-Plot Kotlin API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotly-kt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plotly.kt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visionforge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataForge Visualization Platform
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Other
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kalasim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kalasim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kotlin-jupyter/docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kotlin Kernel for IPython/Jupyter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snark
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gradle" class="md-nav__link">
    <span class="md-ellipsis">
      Gradle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maven" class="md-nav__link">
    <span class="md-ellipsis">
      Maven
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter Notebook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notation" class="md-nav__link">
    <span class="md-ellipsis">
      Notation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-rank-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Higher-Rank Derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      Higher-order derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape-safety" class="md-nav__link">
    <span class="md-ellipsis">
      Shape safety
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-capture" class="md-nav__link">
    <span class="md-ellipsis">
      Variable capture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualization tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataflow-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      Dataflow graphs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loss-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Loss curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how" class="md-nav__link">
    <span class="md-ellipsis">
      How?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-overloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator overloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-class-functions" class="md-nav__link">
    <span class="md-ellipsis">
      First-class functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-stage-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-stage programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algebraic-data-types" class="md-nav__link">
    <span class="md-ellipsis">
      Algebraic data types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extension-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Extension functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple dispatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shape-safe-tensor-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Shape-safe tensor operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-delegation" class="md-nav__link">
    <span class="md-ellipsis">
      Property delegation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental ideas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental ideas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#church-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Church encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Type classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Type arithmetic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grammar" class="md-nav__link">
    <span class="md-ellipsis">
      Grammar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uml-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      UML Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic differentiation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentiable-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Differentiable programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculus" class="md-nav__link">
    <span class="md-ellipsis">
      Calculus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computer-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      Computer algebra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symbolic-mathematics" class="md-nav__link">
    <span class="md-ellipsis">
      Symbolic mathematics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neural-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Neural networks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Type systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-specific-languages" class="md-nav__link">
    <span class="md-ellipsis">
      Domain-specific languages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automated testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ad-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      AD libraries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-thanks" class="md-nav__link">
    <span class="md-ellipsis">
      Special thanks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<!--- @file:Suppress("ClassName") --->
<!--- @file:Suppress("PropertyName") --->

<h1 id="kotlin-type-safe-symbolic-differentiation-for-the-jvm">Kotlin∇: Type-safe Symbolic Differentiation for the JVM</h1>
<p><a href="http://kotlinlang.org"><img alt="Kotlin 1.6.20" src="https://img.shields.io/badge/Kotlin-1.6.20-blue.svg?style=flat&amp;logo=kotlin" /></a>
<a href="https://search.maven.org/search?q=g:%22ai.hypergraph%22"><img alt="Maven Central" src="https://img.shields.io/maven-central/v/ai.hypergraph/kotlingrad.svg?label=Maven%20Central" /></a>
<a href="https://github.com/breandan/kotlingrad/actions"><img alt="CI" src="https://github.com/breandan/kotlingrad/workflows/CI/badge.svg" /></a>
<a href="https://doi.org/10.5281/zenodo.3549076"><img alt="DOI" src="https://zenodo.org/badge/DOI/10.5281/zenodo.3549076.svg" /></a></p>
<p>Kotlin∇ is a type-safe <a href="http://breandan.net/public/masters_thesis.pdf#1a">automatic differentiation</a> framework written in <a href="https://kotl.in">Kotlin</a>. It allows users to express <a href="http://breandan.net/public/masters_thesis.pdf#1b">differentiable programs</a> with higher-dimensional data structures and operators. We attempt to restrict syntactically valid constructions to those which are algebraically valid and can be checked at compile-time. By enforcing these constraints in the type system, it eliminates certain classes of runtime errors that may occur during the execution of a differentiable program. Due to type-inference, most type declarations may be safely omitted by the end-user. Kotlin∇ strives to be expressive, safe, and notationally similar to mathematics.</p>
<h2 id="table-of-contents">Table of contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#features">Supported features</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#notation">Notation</a></li>
<li><a href="#shape-safety">Shape safety</a></li>
<li><a href="#higher-rank-derivatives">Higher-rank</a></li>
<li><a href="#higher-order-derivatives">Higher-order</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#variable-capture">Variable capture</a></li>
<li><a href="#visualization-tools">Visualization</a></li>
<li><a href="#dataflow-graphs">Dataflow graphs</a></li>
<li><a href="#plotting">Plotting functions</a></li>
<li><a href="#loss-curves">Loss curves</a></li>
<li><a href="#testing">Testing and gradient checking</a></li>
<li><a href="#how">How does it work?</a></li>
<li><a href="#operator-overloading">Operator overloading</a></li>
<li><a href="#first-class-functions">First-class functions</a></li>
<li><a href="#multi-stage-programming">Multi-stage programming</a></li>
<li><a href="#extension-functions">Extension functions</a></li>
<li><a href="#algebraic-data-types">Algebraic data types</a></li>
<li><a href="#multiple-dispatch">Multiple dispatch</a></li>
<li><a href="#shape-safe-tensor-operations">Shape-safe tensor operations</a></li>
<li><a href="#intermediate-representation">Intermediate representation</a></li>
<li><a href="#property-delegation">Property delegation</a></li>
<li><a href="#experimental-ideas">Experimental ideas</a></li>
<li><a href="#church-encoding">Church encoding</a></li>
<li><a href="#type-classes">Type classes</a></li>
<li><a href="#type-arithmetic">Type arithmetic</a></li>
<li><a href="#grammar">Formal grammar</a></li>
<li><a href="#uml-diagram">UML diagram</a></li>
<li><a href="#comparison">Comparison to other frameworks</a></li>
<li><a href="#references">References</a></li>
<li><a href="#special-thanks">Acknowledgements</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Inspired by <a href="https://github.com/Functional-AutoDiff/STALINGRAD">Stalin∇</a>, <a href="https://github.com/hips/autograd">Autograd</a>, <a href="https://github.com/DiffSharp/DiffSharp">DiffSharp</a>, <a href="https://github.com/mila-udem/myia">Myia</a>, <a href="https://github.com/ctongfei/nexus">Nexus</a>, <a href="https://github.com/google/tangent">Tangent</a>, <a href="https://github.com/feiwang3311/Lantern">Lantern</a> et al., Kotlin∇ attempts to port recent advancements in automatic differentiation (AD) to the Kotlin language. AD is useful for <a href="https://en.wikipedia.org/wiki/Gradient_descent">gradient descent</a> and has a variety of applications in <a href="https://uhra.herts.ac.uk/bitstream/handle/2299/4342/903843.pdf">numerical optimization</a> and <a href="http://www.jmlr.org/papers/volume18/17-468/17-468.pdf">machine learning</a>. Our implementation adds a number of experimental ideas, including compile-time <a href="#shape-safety">shape-safety</a>, <a href="#multiple-dispatch">algebraic simplification</a> and numerical <a href="#testing">stability checking</a> with property-based testing. We aim to provide an <a href="#operator-overloading">algebraically-grounded</a> implementation of AD for shape-safe tensor operations. Tensors in Kotlin∇ are represented as <a href="https://en.wikipedia.org/wiki/Tensor#As_multidimensional_arrays">multidimensional arrays</a>.</p>
<h2 id="features">Features</h2>
<p>Kotlin∇ currently supports the following features:</p>
<ul>
<li>Arithmetical operations on scalars, vectors and matrices</li>
<li>Shape-safe vector and matrix algebra</li>
<li>Partial and higher-order differentiation on scalars</li>
<li>Property-based testing for numerical gradient checking</li>
<li>Recovery of symbolic derivatives from AD</li>
</ul>
<p>Additionally, it aims to support:</p>
<ul>
<li>PyTorch-style <a href="https://openreview.net/pdf?id=BJJsrmfCZ#section.1">define-by-run</a> semantics</li>
<li>N-dimensional tensors and <a href="https://en.wikipedia.org/wiki/Tensor_contraction">higher-order tensor operators</a></li>
<li>Fully-general AD over control flow, variable reassignment
(via <a href="https://kotlinlang.org/docs/reference/delegated-properties.html">delegation</a>), and array programming, possibly using a typed IR such as <a href="https://github.com/mila-udem/myia">Myia</a></li>
</ul>
<p>All of these features are implemented without access to bytecode or special compiler tricks - just using <a href="https://kotlinlang.org/docs/reference/lambdas.html">higher-order functions and lambdas</a> as shown in <a href="http://www-bcl.cs.may.ie/~barak/papers/toplas-reverse.pdf">Lambda the Ultimate Backpropogator</a>, embedded DSLs a la <a href="https://infoscience.epfl.ch/record/150347/files/gpce63-rompf.pdf">Lightweight Modular Staging</a>, and <a href="https://kotlinlang.org/docs/reference/generics.html">ordinary generics</a>. Please see below for a more detailed <a href="#comparison">feature comparison</a>.</p>
<h2 id="usage">Usage</h2>
<h3 id="installation">Installation</h3>
<p>Kotlin∇ is hosted on <a href="https://s01.oss.sonatype.org/index.html#nexus-search;quick~kotlingrad">Maven Central</a>. An example project is provided <a href="https://github.com/breandan/kotlingrad-consumer">here</a>.</p>
<h4 id="gradle">Gradle</h4>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">dependencies</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;ai.hypergraph:kotlingrad:0.4.7&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="maven">Maven</h4>
<div class="language-xml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">  </span><span class="nt">&lt;groupId&gt;</span>ai.hypergraph<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>kotlingrad<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">  </span><span class="nt">&lt;version&gt;</span>0.4.7<span class="nt">&lt;/version&gt;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></td></tr></table></div>
<h4 id="jupyter-notebook">Jupyter Notebook</h4>
<p>To access Kotlin∇'s notebook support, use the following line magic:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nd">@file</span><span class="p">:</span><span class="n">DependsOn</span><span class="p">(</span><span class="s">&quot;ai.hypergraph:kotlingrad:0.4.7&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>For more information, explore the <a href="samples/notebooks/hello_kotlingrad.ipynb">tutorial</a>.</p>
<h3 id="notation">Notation</h3>
<p>Kotlin∇ operators are <a href="https://en.wikipedia.org/wiki/Higher-order_function">higher-order functions</a>, which take at most two inputs and return a single output, all of which are functions with the same numerical type, and whose shape is denoted using superscript in the rightmost column below. </p>
<table>
<thead>
<tr>
<th style="text-align: center;">Math</th>
<th style="text-align: center;">Infix <sup>&dagger;</sup></th>
<th style="text-align: center;">Prefix</th>
<th style="text-align: center;">Postfix<sup>&Dagger;</sup></th>
<th style="text-align: center;">Operator Type Signature</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{A}(\mathbf{B})\)</span>\)</span><br><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{A}\circ\mathbf{B}\)</span>\)</span></td>
<td style="text-align: center;"><code>a(b)</code><br><code>a of b</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{π}, \texttt{b}: ℝ^{λ} → ℝ^{τ}) → (ℝ^{λ}→ℝ^{π})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{A}\pm\mathbf{B}\)</span>\)</span></td>
<td style="text-align: center;"><code>a + b</code><br><code>a - b</code></td>
<td style="text-align: center;"><code>plus(a, b)</code><br><code>minus(a, b)</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{π}, \texttt{b}: ℝ^{λ} → ℝ^{π}) → (ℝ^{?}→ℝ^{π})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{A}\mathbf{B}\)</span>\)</span></td>
<td style="text-align: center;"><code>a * b</code><br><code>a.times(b)</code></td>
<td style="text-align: center;"><code>times(a, b)</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{m×n}, \texttt{b}: ℝ^{λ}→ℝ^{n×p}) → (ℝ^{?}→ℝ^{m×p})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\frac{\mathbf{A}}{\mathbf{B}}\)</span>\)</span><br><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{A}\mathbf{B}^{-1}\)</span>\)</span></td>
<td style="text-align: center;"><code>a / b</code><br><code>a.div(b)</code></td>
<td style="text-align: center;"><code>div(a, b)</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{m×n}, \texttt{b}: ℝ^{λ}→ℝ^{p×n}) → (ℝ^{?}→ℝ^{m×p})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\pm\mathbf{A}\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>-a</code><br><code>+a</code></td>
<td style="text-align: center;"><code>a.neg()</code><br><code>a.pos()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{π}) → (ℝ^{τ}→ℝ^{π})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\sin{a}\)</span>\)</span><br><span class="arithmatex">\(<span class="arithmatex">\(\cos{a}\)</span>\)</span><br><span class="arithmatex">\(<span class="arithmatex">\(\tan{a}\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>sin(a)</code><br><code>cos(a)</code><br><code>tan(a)</code></td>
<td style="text-align: center;"><code>a.sin()</code><br><code>a.cos()</code><br><code>a.tan()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ→ℝ) → (ℝ→ℝ)\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\ln{a}\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>ln(a)</code><br><code>log(a)</code></td>
<td style="text-align: center;"><code>a.ln()</code><br><code>a.log()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{m×m}) → (ℝ^{τ}→ℝ^{m×m})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\log_{b}a\)</span>\)</span></td>
<td style="text-align: center;"><code>a.log(b)</code></td>
<td style="text-align: center;"><code>log(a, b)</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{m×m}, \texttt{b}: ℝ^{λ}→ℝ^{m×m}) → (ℝ^{?}→ℝ)\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{A}^b\)</span>\)</span></td>
<td style="text-align: center;"><code>a.pow(b)</code></td>
<td style="text-align: center;"><code>pow(a, b)</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{m×m}, \texttt{b}: ℝ^{λ}→ℝ) → (ℝ^{?}→ℝ^{m×m})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\sqrt{A}\)</span>\)</span><br><span class="arithmatex">\(<span class="arithmatex">\(\sqrt[3]{A}\)</span>\)</span></td>
<td style="text-align: center;"><code>a.pow(1.0/2)</code><br><code>a.root(3)</code></td>
<td style="text-align: center;"><code>sqrt(a)</code><br><code>cbrt(a)</code></td>
<td style="text-align: center;"><code>a.sqrt()</code><br><code>a.cbrt()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: ℝ^{τ}→ℝ^{m×m}) → (ℝ^{τ}→ℝ^{m×m})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\frac{da}{db},\frac{\partial{a}}{\partial{b}}\)</span>\)</span> <br> <span class="arithmatex">\(<span class="arithmatex">\(D_b{a}\)</span>\)</span></td>
<td style="text-align: center;"><code>a.d(b)</code><br><code>d(a) / d(b)</code></td>
<td style="text-align: center;"><code>grad(a)[b]</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ)^{*}, \texttt{b}: C(ℝ^{λ}→ℝ)) → (ℝ^{?}→ℝ)\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\nabla{a}\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>grad(a)</code></td>
<td style="text-align: center;"><code>a.grad()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ)) → (ℝ^{τ}→ℝ^{τ})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\nabla_{\mathbf{B}}a\)</span>\)</span></td>
<td style="text-align: center;"><code>a.d(b)</code><br><code>a.grad(b)</code></td>
<td style="text-align: center;"><code>grad(a, b)</code><br><code>grad(a)[b]</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ^{π}), \texttt{b}: C(ℝ^{λ}→ℝ^{ω})) → (ℝ^{?}→ℝ^{π×ω})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\nabla\cdot{\mathbf{A}}\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>divg(a)</code></td>
<td style="text-align: center;"><code>a.divg()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ^{m})) → (ℝ^{τ}→ℝ)\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\nabla\times{\mathbf{A}}\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>curl(a)</code></td>
<td style="text-align: center;"><code>a.curl()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{3}→ℝ^{3})) → (ℝ^{3}→ℝ^{3})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\mathcal{J}(\mathbf{A})\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>grad(a)</code></td>
<td style="text-align: center;"><code>a.grad()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ^{m})) → (ℝ^{τ}→ℝ^{m×τ})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\mathbf{H}(a)\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>hess(a)</code></td>
<td style="text-align: center;"><code>a.hess()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ)) → (ℝ^{τ}→ℝ^{τ×τ})\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(\Delta{a},\nabla^{2}a\)</span>\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><code>lapl(a)</code></td>
<td style="text-align: center;"><code>a.lapl()</code></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\((\texttt{a}: C(ℝ^{τ}→ℝ)) → (ℝ^{τ}→ℝ^{τ})\)</span>\)</span></td>
</tr>
</tbody>
</table>
<p>ℝ can be a <code>Double</code>, <code>Float</code> or <code>BigDecimal</code>. Specialized operators are defined for subsets of ℝ, e.g., <code>Int</code>, <code>Short</code> or <code>BigInteger</code> for subsets of ℤ, however differentiation is <a href="https://en.wikipedia.org/wiki/Differentiable_function">only defined</a> for continuously differentiable functions on ℝ.</p>
<p><sup>&dagger;</sup> <code>a</code> and <code>b</code> are higher-order functions. These may be constants (e.g., <code>0</code>, <code>1.0</code>), variables (e.g., <code>Var()</code>) or expressions (e.g., <code>x + 1</code>, <code>2 * x + y</code>).</p>
<p><sup>&Dagger;</sup> For infix notation, <code>.</code> is optional. Parentheses are also optional depending on <a href="https://kotlinlang.org/docs/reference/functions.html#infix-notation">precedence</a>.</p>
<p><sup>&sect;</sup> Matrix division is defined iff <strong>B</strong> is invertible, although it could be possible to redefine this operator using the <a href="https://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_inverse">Moore-Penrose inverse</a>.</p>
<p><sup>&lowast;</sup> Where C(ℝ<sup>m</sup>) is the space of all continuous functions over ℝ. If the function is not over ℝ, it will fail at compile-time. If the function is over ℝ but not continuous differentiable at the point under consideration, it will fail at runtime.</p>
<p><sup>?</sup> The input shape is tracked at runtime, but not at the type level. While it would be nice to infer a union type bound over the inputs of binary functions, it is likely impossible using the Kotlin type system <a href="core/src/commonMain/gen/ai/hypergraph/kotlingrad/typelevel/arity/Variables.kt">without great effort</a>. If the user desires type checking when invoking higher order functions with literal values, they will need to specify the combined input type explicitly or do so at runtime.</p>
<p><sup>τ, λ, π, ω</sup> Arbitrary products.</p>
<h3 id="higher-rank-derivatives">Higher-Rank Derivatives</h3>
<p>Kotlin∇ supports derivatives between tensors of up to rank 2. The shape of a tensor derivative depends on (1) the shape of the function under differentiation and (2) the shape of the variable with respect to which we are differentiating.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">I/O Shape</th>
<th style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ\)</span>\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{m}\)</span>\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{j×k}\)</span>\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ\)</span>\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ\)</span>\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{m}\)</span>\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{j×k}\)</span>\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{n}\)</span>\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{n}\)</span>\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{m×n}\)</span>\)</span></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{h×i}\)</span>\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(<span class="arithmatex">\(ℝ^{?}→ℝ^{h×i}\)</span>\)</span></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
</tbody>
</table>
<p>Matrix-by-vector, vector-by-matrix, and matrix-by-matrix derivatives require rank 3+ tensors and are currently unsupported.</p>
<h3 id="higher-order-derivatives">Higher-order derivatives</h3>
<p>Kotlin∇ supports arbitrary order derivatives on scalar functions, and up to 2<sup>nd</sup> order derivatives on vector functions. Higher-order derivatives on matrix functions are unsupported.</p>
<h3 id="shape-safety">Shape safety</h3>
<p>Shape safety is an important concept in Kotlin∇. There are three broad strategies for handling shape errors:</p>
<ul>
<li>Hide the error somehow by implicitly reshaping or <a href="https://docs.scipy.org/doc/numpy-1.10.4/user/basics.broadcasting.html">broadcasting</a> arrays</li>
<li>Announce the error at runtime, with a relevant message, e.g., <a href="https://www.tensorflow.org/api_docs/python/tf/errors/InvalidArgumentError"><code>InvalidArgumentError</code></a></li>
<li>Do not allow programs which can result in a shape error to compile</li>
</ul>
<p>In Kotlin∇, we use the last strategy to check the shape of tensor operations. Consider the following program:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span>
<span class="normal"><a href="#__codelineno-3-8">8</a></span>
<span class="normal"><a href="#__codelineno-3-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1">// Inferred type: Vec&lt;Double, D2&gt;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="c1">// Inferred type: Vec&lt;Double, D3&gt;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="kd">val</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="m">3.0</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="kd">val</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="c1">// Does not compile, shape mismatch</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="c1">// a + b</span>
</code></pre></div></td></tr></table></div>
<p>Attempting to sum two vectors whose shapes do not match will fail to compile, and they must be explicitly resized.</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1">// Inferred type: Mat&lt;Double, D1, D4&gt;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat1x4</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="m">3.0</span><span class="p">,</span><span class="w"> </span><span class="m">4.0</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1">// Inferred type: Mat&lt;Double, D4, D1&gt;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kd">val</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat4x1</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="m">3.0</span><span class="p">,</span><span class="w"> </span><span class="m">4.0</span><span class="p">)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="kd">val</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="c1">// Does not compile, inner dimension mismatch</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="c1">// a * a</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="c1">// b * b</span>
</code></pre></div></td></tr></table></div>
<p>Similarly, attempting to multiply two matrices whose inner dimensions do not match will fail to compile.</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat2x4</span><span class="p">(</span><span class="w"> </span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="m">3.0</span><span class="p">,</span><span class="w"> </span><span class="m">4.0</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">  </span><span class="m">5.0</span><span class="p">,</span><span class="w"> </span><span class="m">6.0</span><span class="p">,</span><span class="w"> </span><span class="m">7.0</span><span class="p">,</span><span class="w"> </span><span class="m">8.0</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="kd">val</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat4x2</span><span class="p">(</span><span class="w"> </span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">  </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">  </span><span class="m">3.0</span><span class="p">,</span><span class="w"> </span><span class="m">4.0</span><span class="p">,</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">  </span><span class="m">5.0</span><span class="p">,</span><span class="w"> </span><span class="m">6.0</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">  </span><span class="m">7.0</span><span class="p">,</span><span class="w"> </span><span class="m">8.0</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="p">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="c1">// Types are optional, but encouraged</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="kd">val</span><span class="w"> </span><span class="nv">c</span><span class="p">:</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">Double</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="kd">val</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat2x1</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">)</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="kd">val</span><span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="kd">val</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat3x1</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="m">3.0</span><span class="p">)</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="c1">// Does not compile, inner dimension mismatch</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="c1">// e * f</span>
</code></pre></div></td></tr></table></div>
<p>Explicit types are optional but encouraged. <a href="https://www.youtube.com/watch?v=MyljSWm0Y_k">Type inference</a> helps preserve shape information over long programs.</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kd">fun</span><span class="w"> </span><span class="nf">someMatFun</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">Double</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="p">,</span><span class="w"> </span><span class="n">D1</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">Double</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="kd">fun</span><span class="w"> </span><span class="nf">someMatFun</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">Double</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</code></pre></div></td></tr></table></div>
<p>When writing a function, it is mandatory to declare the input type(s), but the return type <a href="https://kotlinlang.org/docs/reference/functions.html#explicit-return-types">may be omitted</a>. Shape-safety is currently supported up to rank-2 tensors, i.e. matrices.</p>
<h3 id="example">Example</h3>
<p>The following example shows how to derive higher-order partials of a function <code>z</code> of type ℝ²→ℝ:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">4</span><span class="w">  </span><span class="c1">// Infix notation</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="kd">val</span><span class="w"> </span><span class="err">`∂</span><span class="nv">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">          </span><span class="c1">// Leibniz notation [Christianson, 2012]</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="kd">val</span><span class="w"> </span><span class="err">`∂</span><span class="nv">z</span><span class="err">∕∂</span><span class="n">y</span><span class="err">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">          </span><span class="c1">// Partial derivatives</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="kd">val</span><span class="w"> </span><span class="err">`∂²</span><span class="nv">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">²`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="err">`∂</span><span class="n">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c1">// Higher-order derivatives</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="kd">val</span><span class="w"> </span><span class="err">`∂²</span><span class="nv">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">∂</span><span class="n">y</span><span class="err">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="err">`∂</span><span class="n">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="c1">// Higher-order partials</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="kd">val</span><span class="w"> </span><span class="err">`∇</span><span class="nv">z</span><span class="err">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="p">.</span><span class="na">grad</span><span class="p">()</span><span class="w">                </span><span class="c1">// Gradient operator</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="kd">val</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arrayOf</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="n">println</span><span class="p">(</span><span class="s">&quot;z(x, y) \t= </span><span class="si">$</span><span class="n">z</span><span class="s">\n&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">  </span><span class="s">&quot;z(</span><span class="si">${</span><span class="n">values</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="p">}.</span><span class="na">joinToString</span><span class="p">()</span><span class="si">}</span><span class="s">) \t\t= </span><span class="si">${</span><span class="n">z</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s">\n&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">  </span><span class="s">&quot;∂z/∂x \t\t= </span><span class="err">$</span><span class="s">`∂z∕∂x` \n\t\t= &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">`∂</span><span class="n">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">`</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">  </span><span class="s">&quot;∂z/∂y \t\t= </span><span class="err">$</span><span class="s">`∂z∕∂y` \n\t\t= &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">`∂</span><span class="n">z</span><span class="err">∕∂</span><span class="n">y</span><span class="err">`</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">  </span><span class="s">&quot;∂²z/∂x² \t= </span><span class="err">$</span><span class="s">`∂z∕∂y` \n\t\t= &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">`∂²</span><span class="n">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">²`</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">  </span><span class="s">&quot;∂²z/∂x∂y \t= </span><span class="err">$</span><span class="s">`∂²z∕∂x∂y` \n\t\t= &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">`∂²</span><span class="n">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">∂</span><span class="n">y</span><span class="err">`</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">  </span><span class="s">&quot;∇z \t\t= </span><span class="err">$</span><span class="s">`∇z` \n\t\t= [</span><span class="si">${</span><span class="err">`∇</span><span class="n">z</span><span class="err">`</span><span class="o">[</span><span class="n">x</span><span class="o">]!!</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s">, </span><span class="si">${</span><span class="err">`∇</span><span class="n">z</span><span class="err">`</span><span class="o">[</span><span class="n">y</span><span class="o">]!!</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s">]ᵀ&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Any backticks and unicode characters above are simply for readability and have no effect on the behavior. Running <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/HelloKotlingrad.kt">this program</a> via <code>./gradlew HelloKotlingrad</code> should produce the following output:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>z(x, y)         = ((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>z(0, 1)         = 0.0
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>∂z/∂x           = d(((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)) / d(x) 
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>                = 4.0
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>∂z/∂y           = d(((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)) / d(y) 
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>                = 0.0
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>∂²z/∂x²         = d(((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)) / d(y) 
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>                = 4.0
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>∂²z/∂x∂y        = d(d(((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)) / d(x)) / d(y) 
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>                = 4.0
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>∇z              = {y=d(((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)) / d(y), x=d(((x) * ((- (sin((x) * (y)))) + (y))) * (4.0)) / d(x)} 
<a id="__codelineno-8-12" name="__codelineno-8-12"></a>                = [4.0, 0.0]ᵀ
</code></pre></div></td></tr></table></div>
<h3 id="variable-capture">Variable capture</h3>
<p>Not only does Kotlin∇'s type system encode <a href="#shape-safety">output shape</a>, it is also capable of tracking free and bound variables, for order-independent name binding and partial application. Expressions inhabited by free variables are typed as functions until fully bound, at which time they return a concrete value. Consider the following example:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span>
<span class="normal"><a href="#__codelineno-9-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.0</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">p0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">X</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">3.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Name binding</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="kd">val</span><span class="w"> </span><span class="nv">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">X</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)(</span><span class="n">Z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Variadic currying</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="kd">val</span><span class="w"> </span><span class="nv">p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">Z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)(</span><span class="n">X</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Any order is possible</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="kd">val</span><span class="w"> </span><span class="nv">p4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">Z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)(</span><span class="n">X</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)(</span><span class="n">Y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Proper currying</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="kd">val</span><span class="w"> </span><span class="nv">p5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">Z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)(</span><span class="n">X</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Returns a partially applied function</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="kd">val</span><span class="w"> </span><span class="nv">p6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0</span><span class="p">)(</span><span class="n">Y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Does not compile</span>
</code></pre></div></td></tr></table></div>
<p>This feature is made possible by encoding a type-level <a href="https://en.wikipedia.org/wiki/Hasse_diagram">Hasse diagram</a> over a small set of predefined variable names, with skip-connections for variadic combination and partial application. Curious readers may glean further details by referring to <a href="core/src/commonMain/gen/ai/hypergraph/kotlingrad/typelevel/arity/Variables.kt">the implementation</a> and <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/VariableCapture.kt">usage example</a>.</p>
<h2 id="visualization-tools">Visualization tools</h2>
<p>Kotlin∇ provides various graphical tools that can be used for visual debugging.</p>
<h3 id="dataflow-graphs">Dataflow graphs</h3>
<p>Kotlin∇ functions are a type of <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">directed acyclic graph</a>, called dataflow graphs (DFGs). For example, running the expression <code>((1 + x * 2 - 3 + y + z / y).d(y).d(x) + z / y * 3 - 2).render()</code> will display the following DFG:</p>
<p><img alt="" src="samples/src/main/resources/dataflow.svg" /></p>
<p>Red and blue edges indicate the right and left inputs to a binary operator, respectively. Consider the DFG for a batch of stochastic gradients on <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/LinearRegression.kt">linear regression</a>, which can be written in matrix form as <img src="https://render.githubusercontent.com/render/math?math=\nabla_{\Theta}||\mathbf{Y} - \mathbf{X}\Theta||^2">:</p>
<p><img alt="" src="samples/src/main/resources/lr_batch_loss_graph.svg" /></p>
<p>Thetas represent the hidden parameters under differentiation and the constants are the batch inputs (<strong>X</strong>) and targets (<strong>Y</strong>). When all the free variables are bound to numerical values, the graph collapses into a single node, which can be unwrapped into a Kotlin <code>Number</code>.</p>
<h3 id="plotting">Plotting</h3>
<p>To generate the <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/Plot2D.kt">sample 2D plots</a> below, run <code>./gradlew Plot2D</code>.</p>
<p align="center"><img src="samples/src/main/resources/plot.svg"></p>
<p align="center"><img src="samples/src/main/resources/hermite.svg"></p>

<p>Plotting is also possible in higher dimensions, <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/Plot3D.kt">for example</a> in 3D via <code>./gradlew Plot3D</code>:</p>
<p><img alt="" src="samples/src/main/resources/ripple.png" />
<img alt="" src="samples/src/main/resources/pulsar.png" />
<img alt="" src="samples/src/main/resources/starquake.png" />
<img alt="" src="samples/src/main/resources/novaflux.png" /></p>
<h3 id="loss-curves">Loss curves</h3>
<p>Gradient descent is one application for Kotlin∇. Below, is a typical loss curve of SGD on <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/MLP.kt">a multilayer perceptron</a>:</p>
<p><img alt="" src="samples/src/main/resources/mlp_loss.svg" /></p>
<p>To train the model, execute <code>./gradlew MLP</code> from within the parent directory.</p>
<h2 id="testing">Testing</h2>
<p>To run <a href="core/src/jvmTest/kotlin/ai/hypergraph/kotlingrad">the tests</a>, execute <code>../gradlew allTests</code> from the <code>core</code> directory.</p>
<p>Kotlin∇ claims to eliminate certain runtime errors, but how do we know the proposed implementation is not incorrect? One method, borrowed from the Haskell community, is called <a href="http://breandan.net/public/masters_thesis.pdf#33">property-based testing</a> (PBT), closely related to <a href="http://breandan.net/public/masters_thesis.pdf#34">metamorphic testing</a>. Notable implementations include <a href="https://github.com/nick8325/quickcheck">QuickCheck</a>, <a href="https://github.com/HypothesisWorks/hypothesis">Hypothesis</a> and <a href="http://www.scalatest.org/user_guide/property_based_testing">ScalaTest</a> (ported to Kotlin in <a href="https://github.com/kotest/kotest">Kotest</a>). PBT uses algebraic properties to verify the result of an operation by constructing semantically equivalent but syntactically distinct expressions, which should produce the same answer. Kotlin∇ uses two such equivalences to validate its AD implementation:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Differentiation_rules">Analytic differentiation</a>: manually differentiate and compare the values returned on a subset of the domain with AD.</li>
<li><a href="http://breandan.net/public/masters_thesis.pdf#5a">Finite difference approximation</a>: sample space of symbolic (differentiable) functions, comparing results of AD to FD.</li>
</ul>
<p>For example, consider the following test, which checks whether the analytical derivative and the automatic derivative, when evaluated at a given point, are equal to each other within the limits of numerical precision:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="kd">val</span><span class="w"> </span><span class="nv">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">            </span><span class="c1">// Function under test</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="kd">val</span><span class="w"> </span><span class="err">`∂</span><span class="nv">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">               </span><span class="c1">// Automatic derivative</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="kd">val</span><span class="w"> </span><span class="nv">manualDx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1">// Analytical derivative </span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="s">&quot;∂z/∂x should be y * (cos(x * y) * y - 1)&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">  </span><span class="n">NumericalGenerator</span><span class="p">.</span><span class="na">assertAll</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ẋ</span><span class="p">,</span><span class="w"> </span><span class="n">ẏ</span><span class="w"> </span><span class="o">-&gt;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">    </span><span class="c1">// Evaluate the results at a given seed</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">autoEval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">`∂</span><span class="n">z</span><span class="err">∕∂</span><span class="n">x</span><span class="err">`</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ẋ</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ẏ</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">manualEval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">manualDx</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ẋ</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ẏ</span><span class="p">)</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">    </span><span class="c1">// Should pass iff Δ(adEval, manualEval) &lt; Ɛ</span>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">    </span><span class="n">autoEval</span><span class="w"> </span><span class="n">shouldBeApproximately</span><span class="w"> </span><span class="n">manualEval</span>
<a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>PBT will search the input space for two numerical values <code>ẋ</code> and <code>ẏ</code>, which violate the specification, then <a href="https://hackage.haskell.org/package/QuickCheck-2.12.6.1/docs/Test-QuickCheck-Arbitrary.html#v:shrink">"shrink"</a> them to discover pass-fail boundary values. We can construct a similar test using finite differences:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="s">&quot;d(sin x)/dx should be equal to (sin(x + dx) - sin(x)) / dx&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">  </span><span class="n">NumericalGenerator</span><span class="p">.</span><span class="na">assertAll</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ẋ</span><span class="w"> </span><span class="o">-&gt;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="err">`</span><span class="nv">df</span><span class="err">∕</span><span class="n">dx</span><span class="err">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">adEval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">`</span><span class="n">df</span><span class="err">∕</span><span class="n">dx</span><span class="err">`</span><span class="p">(</span><span class="n">ẋ</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1E-8</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">    </span><span class="c1">// Since ẋ is a raw numeric type, sin =&gt; kotlin.math.sin</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">fdEval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">ẋ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">ẋ</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dx</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w">    </span><span class="n">adEval</span><span class="w"> </span><span class="n">shouldBeApproximately</span><span class="w"> </span><span class="n">fdEval</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><img alt="" src="samples/src/main/resources/comparison.svg" /></p>
<p>Above, we <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/ADSDComparison.kt">compare numerical errors</a> for three types of computational differentiation against infinite precision symbolic differentiation (IP):</p>
<ol>
<li>Finite precision automatic differentiation (AD)</li>
<li>Finite precision symbolic differentiation (SD)</li>
<li>Finite precision finite differences (FD)</li>
</ol>
<p>AD and SD both exhibit relative errors (i.e. with respect to each other) several orders of magnitude lower than their absolute errors (i.e. with respect to IP), which roughly agree to within numerical precision. As expected, FD exhibits numerical error significantly higher than AD and SD due to the inaccuracy of floating-point division.</p>
<p>There are many other ways to independently verify the numerical gradient, such as <a href="https://en.wikipedia.org/wiki/Dual_number#Differentiation">dual numbers</a> or the <a href="https://timvieira.github.io/blog/post/2014/08/07/complex-step-derivative/">complex step derivative</a>. Another method is to compare the numerical output against a well-known implementation, such as <a href="https://github.com/JetBrains/kotlin-native/tree/master/samples/tensorflow">TensorFlow</a>. We plan to conduct a more thorough comparison of numerical accuracy and performance.</p>
<h2 id="how">How?</h2>
<p>To understand the core of Kotlin∇'s AD implementation, please refer to the <a href="core/src/commonMain/kotlin/ai/hypergraph/kotlingrad/api/Scalar.kt">scalar example</a>.</p>
<p>This project relies on a few Kotlin-specific language features, which together enable a concise, flexible and type-safe user interface. The following features have proven beneficial to the development of Kotlin∇:</p>
<h4 id="operator-overloading">Operator overloading</h4>
<p><a href="https://kotlinlang.org/docs/reference/operator-overloading.html">Operator overloading</a> enables concise notation for arithmetic on abstract types, where the types encode <a href="http://breandan.net/public/masters_thesis.pdf#page=58">algebraic structures</a>, e.g., <code>Group</code>, <code>Ring</code>, and <code>Field</code>. These abstractions are extensible to other kinds of mathematical structures, such as complex numbers and quaternions.</p>
<p>For example, suppose we have an interface <code>Group</code>, which overloads the operators <code>+</code> and <code>*</code>, and is defined like so:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nc">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">  </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">plus</span><span class="p">(</span><span class="n">addend</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">  </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">times</span><span class="p">(</span><span class="n">multiplicand</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Here, we specify a recursive type bound using a method known as <a href="http://staff.ustc.edu.cn/~xyfeng/teaching/FOPL/lectureNotes/CookFBound89.pdf">F-bounded quantification</a> to ensure that operations return the concrete type variable <code>T</code>, rather than something more abstract like <code>Group</code>. Imagine a class <code>Fun</code> that has implemented <code>Group</code>. It can be used as follows:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="err">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="err">&gt; </span><span class="nf">cubed</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="err">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="err">&gt; </span><span class="nf">twiceCubed</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cubed</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cubed</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Like <a href="https://docs.python.org/3.4/library/operator.html">Python</a>, Kotlin supports overloading a <a href="https://kotlinlang.org/docs/reference/operator-overloading.html">limited set of operators</a>, which are evaluated using a <a href="https://kotlinlang.org/docs/reference/grammar.html#precedence">fixed precedence</a>. In the current version of Kotlin∇, operators do not perform any computation, they simply construct a directed acyclic graph representing the symbolic expression. Expressions are only evaluated when invoked as a function.</p>
<h4 id="first-class-functions">First-class functions</h4>
<p>With <a href="https://kotlinlang.org/docs/reference/lambdas.html">higher-order functions and lambdas</a>, Kotlin treats <a href="https://en.wikipedia.org/wiki/First-class_function">functions as first-class citizens</a>. This allows us to represent mathematical functions and programming functions with the same underlying abstractions (typed FP). Several <a href="http://www-bcl.cs.may.ie/~barak/papers/toplas-reverse.pdf">recent</a> <a href="https://papers.nips.cc/paper/8221-backpropagation-with-callbacks-foundations-for-efficient-and-expressive-differentiable-programming.pdf">papers</a> have demonstrated the expressiveness of this paradigm for automatic differentiation.</p>
<p>In Kotlin∇, all expressions can be treated as functions. For example:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="err">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="err">&gt; </span><span class="nf">makePoly</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="n">Var</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">:</span><span class="w"> </span><span class="n">Var</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="kd">val</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="kd">val</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makePoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="kd">val</span><span class="w"> </span><span class="nv">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Returns a value</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="n">println</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="c1">// Prints: 7</span>
</code></pre></div></td></tr></table></div>
<p>Additionally, it is possible to build functions consisting of varying dimensional inputs:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="err">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="err">&gt; </span><span class="nf">mlp</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span><span class="w"> </span><span class="n">VFun</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">:</span><span class="w"> </span><span class="n">MFun</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="p">((</span><span class="n">p1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="n">dot</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p3</span><span class="p">)</span><span class="w"> </span><span class="n">pow</span><span class="w"> </span><span class="n">p3</span>
</code></pre></div></td></tr></table></div>
<h4 id="multi-stage-programming">Multi-stage programming</h4>
<p>Kotlin∇ uses <a href="#operator-overloading">operator overloading</a> in the host language to first construct a <a href="#dataflow-graphs">dataflow graph</a>, but evaluates the graph lazily. Called "multi-stage programming", or <em>staging</em>, this is a metaprogramming technique from the <a href="http://ocamllabs.io/iocamljs/staging.html">ML community</a> which enables type-safe runtime code translation and compilation. More recently, staging has been put to effective use for <a href="https://static.csg.ci.i.u-tokyo.ac.jp/papers/14/scherr-ecoop2014.pdf">compiling embedded DSLs</a> similar to Kotlin∇.</p>
<p>In its current form, Kotlin∇ takes a "shallow embedding" approach. Similar to an <a href="https://en.wikipedia.org/wiki/Interpreter_pattern">interpreter</a>, it adheres closely to the user-defined program and does not perform much code specialization or rewriting for optimization purposes. Unlike an interpreter, it postpones evaluation until all free variables in an expression have been bound. Consider the following snippet, which decides when to evaluate an expression:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kd">var</span><span class="w"> </span><span class="nv">EAGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">newBindings</span><span class="p">:</span><span class="w"> </span><span class="n">Bindings</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">    </span><span class="n">Composition</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">newBindings</span><span class="p">).</span><span class="na">run</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bindings</span><span class="p">.</span><span class="na">complete</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">EAGER</span><span class="p">)</span><span class="w"> </span><span class="n">evaluate</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>If <code>bindings</code> are <code>complete</code>, this means there are no unbound variables remaining (implementation omitted for brevity), and we can evaluate the expression to obtain a numerical result. Suppose we have the following user code:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span>
<span class="normal"><a href="#__codelineno-17-6">6</a></span>
<span class="normal"><a href="#__codelineno-17-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="kd">val</span><span class="w"> </span><span class="nv">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="kd">val</span><span class="w"> </span><span class="nv">f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="kd">var</span><span class="w"> </span><span class="nv">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1</span><span class="p">).</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Prints: (x + y * z)(x=1)</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="kd">var</span><span class="w"> </span><span class="nv">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">2</span><span class="p">).</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Prints: (x + y * z)(x=1)(y=2)</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="kd">var</span><span class="w"> </span><span class="nv">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">3</span><span class="p">).</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Prints: 7</span>
</code></pre></div></td></tr></table></div>
<p>Once the last line is reached, all variables are bound, and instead of returning a <code>Composition</code>, Kotlin∇ evaluates the function, returning a constant. Alternatively, if <code>EAGER</code> mode is enabled, each invocation is applied as early as possible:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="n">EAGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1</span><span class="p">).</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Prints: 1 + y * z</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">2</span><span class="p">).</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Prints: 1 + 2 * z</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">3</span><span class="p">).</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Prints: 7</span>
</code></pre></div></td></tr></table></div>
<p>In the following section, we describe how evaluation works.</p>
<h4 id="algebraic-data-types">Algebraic data types</h4>
<p><a href="https://en.wikipedia.org/wiki/Algebraic_data_type">Algebraic data types</a> (ADTs) in the form of <a href="https://kotlinlang.org/docs/reference/sealed-classes.html">sealed classes</a> (a.k.a. sum types) facilitate a limited form of pattern matching over a closed set of subclasses. By using these, the compiler forces us to provide an exhaustive control flow when type checking a sealed class. Consider the following classes:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span>
<span class="normal"><a href="#__codelineno-19-5">5</a></span>
<span class="normal"><a href="#__codelineno-19-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Const</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">number</span><span class="p">:</span><span class="w"> </span><span class="n">Number</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Sum</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">left</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">right</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Prod</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">left</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">right</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Var</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">variables</span><span class="p">:</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Var</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">setOf</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Zero</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">:</span><span class="w"> </span><span class="n">Const</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="m">0.0</span><span class="p">)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="kd">class</span><span class="w"> </span><span class="nc">One</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">:</span><span class="w"> </span><span class="n">Const</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="m">1.0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>When checking the type of a sealed class, consumers must explicitly handle every case, as incomplete control flow will produce a compiler error rather than fail at runtime. Consider a simplified definition of the superclass <code>Fun</code>, which defines invocation and differentiation using a restricted form of pattern matching:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">open</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">variables</span><span class="p">:</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Var</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emptySet</span><span class="p">()):</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="w">    </span><span class="k">constructor</span><span class="p">(</span><span class="k">vararg</span><span class="w"> </span><span class="n">fns</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="k">this</span><span class="p">(</span><span class="n">fns</span><span class="p">.</span><span class="na">flatMap</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">variables</span><span class="w"> </span><span class="p">}.</span><span class="na">toSet</span><span class="p">())</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">    </span><span class="c1">// Since the subclasses of Fun are a closed set, no `else  ...` is required.</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">    </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">map</span><span class="p">:</span><span class="w"> </span><span class="n">Bindings</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">this</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">Var</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">map</span><span class="p">.</span><span class="na">getOrElse</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Partial application is permitted</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">Prod</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">left</span><span class="p">(</span><span class="n">map</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">(</span><span class="n">map</span><span class="p">)</span><span class="w"> </span><span class="c1">// Smart casting implicitly casts after checking</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">Sum</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">left</span><span class="p">(</span><span class="n">map</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">right</span><span class="p">(</span><span class="n">map</span><span class="p">)</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="n">Var</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="w">       </span><span class="k">is</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Zero</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">       </span><span class="k">is</span><span class="w"> </span><span class="n">Var</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">variable</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">Zero</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="w">       </span><span class="c1">// Product rule: d(u*v)/dx = du/dx * v + u * dv/dx</span>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">       </span><span class="k">is</span><span class="w"> </span><span class="n">Prod</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">left</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="w">       </span><span class="k">is</span><span class="w"> </span><span class="n">Sum</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">left</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">right</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="w">    </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">plus</span><span class="p">(</span><span class="n">addend</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sum</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">addend</span><span class="p">)</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a>
<a id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="w">    </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">times</span><span class="p">(</span><span class="n">multiplicand</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Prod</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">multiplicand</span><span class="p">)</span>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Symbolic differentiation as implemented by Kotlin∇ has two distinct passes, one for differentiation and one for evaluation. Differentiation constitutes a top-down substitution process on the computation graph and evaluation propagates the values from the bottom, up. This reduction semantics for this procedure are described more precisely in <a href="https://github.com/breandan/kotlingrad/blob/master/specification.md#reduction-semantics">the specification</a>.</p>
<p><a href="http://breandan.net/public/masters_thesis.pdf#page=58"><img alt="" src="latex/figures/kotlingrad_diagram.png" /></a></p>
<p>Kotlin∇ functions are not only data structures, but Kotlin functions which can be invoked by passing a <a href="/core/src/commonMain/kotlin/ai/hypergraph/kotlingrad/api/Bindings.kt"><code>Bindings</code></a> instance (effectively, a <code>Map&lt;Fun&lt;X&gt;, Fun&lt;X&gt;&gt;</code>). To enable this functionality, we overload the <a href="https://kotlinlang.org/docs/reference/operator-overloading.html#invoke"><code>invoke</code> operator</a>, then recurse over the graph, using <code>Bindings</code> as a lookup table. If a matching subexpression is found, we propagate the bound value instead of the matching function. This is known as the <a href="https://en.wikipedia.org/wiki/Interpreter_pattern">interpreter pattern</a>.</p>
<p>Kotlin's <a href="https://kotlinlang.org/docs/reference/typecasts.html#smart-casts">smart casting</a> is an example of <a href="https://en.wikipedia.org/wiki/Flow-sensitive_typing">flow-sensitive type analysis</a> where the abstract type <code>Fun</code> can be treated as <code>Sum</code> after performing an <code>is Sum</code> check. Without smart casting, we would need to write <code>(this as Sum).left</code> to access the member, <code>left</code>, causing a potential <code>ClassCastException</code> if the cast were mistaken.</p>
<h4 id="extension-functions">Extension functions</h4>
<p>By using <a href="https://kotlinlang.org/docs/reference/extensions.html">extension functions</a>, users can convert between numerical types in the host language and our eDSL, by augmenting classes with additional operators. <a href="https://proandroiddev.com/an-introduction-context-oriented-programming-in-kotlin-2e79d316b0a2">Context-oriented programming</a>, allows users to define custom extensions without requiring subclasses or inheritance.</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Const</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">number</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">()</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Sum</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">e1</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">e2</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">()</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Prod</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">e1</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">e2</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="p">()</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="w">  </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">plus</span><span class="p">(</span><span class="n">addend</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sum</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">addend</span><span class="p">)</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="w">  </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">times</span><span class="p">(</span><span class="n">multiplicand</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Prod</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">multiplicand</span><span class="p">)</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="p">}</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="kd">object</span><span class="w"> </span><span class="nc">DoubleContext</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">  </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">Number</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span><span class="w"> </span><span class="n">Fun</span><span class="o">&lt;</span><span class="kt">Double</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Const</span><span class="p">(</span><span class="n">toDouble</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">expr</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, we can use the context to define another extension, <code>Fun.multiplyByTwo</code>, which computes the product inside a <code>DoubleContext</code>, using the operator overload we defined above:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kd">fun</span><span class="w"> </span><span class="nf">Fun</span><span class="o">&lt;</span><span class="kt">Double</span><span class="o">&gt;</span><span class="p">.</span><span class="na">multiplyByTwo</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">with</span><span class="p">(</span><span class="n">DoubleContext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Uses `*` operator in DoubleContext</span>
</code></pre></div></td></tr></table></div>
<p>Extensions can also be defined in another file or context and imported on demand. For example, Kotlin∇ also uses extensions to define <a href="#shape-safe-tensor-operations">shape-safe</a> constructors and operators for vector and matrix arithmetic.</p>
<h4 id="multiple-dispatch">Multiple dispatch</h4>
<p>In conjunction with ADTs, Kotlin∇ also uses <a href="https://en.wikipedia.org/wiki/Multiple_dispatch">multiple dispatch</a> to instantiate the most specific result type of <a href="https://github.com/breandan/kotlingrad/blob/09f4aaf789238820fb5285706e0f1e22ade59b7c/src/main/kotlin/ai/hypergraph/kotlingrad/functions/Function.kt#L24-L38">applying an operator</a> based on the type of its operands. While multiple dispatch is not an explicit language feature, it can be emulated using inheritance.</p>
<p>Building on the previous example, a common task in AD is to <a href="http://deeplearning.net/software/theano/extending/optimization.html">simplify a graph</a>. This is useful in order to minimize the total number of calculations required, improving numerical stability. We can eagerly simplify expressions based on algebraic <a href="https://en.wikipedia.org/wiki/Rule_of_replacement">rules of replacement</a>. Smart casting allows us to access members of a class after checking its type, without explicitly casting it:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">times</span><span class="p">(</span><span class="n">multiplicand</span><span class="p">:</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="w">  </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">this</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">  </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">multiplicand</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">  </span><span class="n">multiplicand</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">this</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">  </span><span class="n">multiplicand</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">multiplicand</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">  </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">multiplicand</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">two</span><span class="p">)</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="w">  </span><span class="k">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">multiplicand</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">const</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multiplicand</span><span class="p">.</span><span class="na">value</span><span class="p">)</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="w">  </span><span class="c1">// Further simplification is possible using rules of replacement</span>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Prod</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">multiplicand</span><span class="p">)</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="p">}</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Const</span><span class="p">(</span><span class="m">2.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Sum</span><span class="p">(</span><span class="n">Var</span><span class="p">(</span><span class="m">2.0</span><span class="p">),</span><span class="w"> </span><span class="n">Const</span><span class="p">(</span><span class="m">3.0</span><span class="p">))</span><span class="w"> </span><span class="c1">// Sum(Prod(Const(2.0), Var(2.0)), Const(6.0))</span>
</code></pre></div></td></tr></table></div>
<p>This allows us to put all related control flow on a single abstract class which is inherited by subclasses, simplifying readability, debugging and refactoring.</p>
<h4 id="shape-safe-tensor-operations">Shape-safe tensor operations</h4>
<p>While first-class <a href="https://wiki.haskell.org/Dependent_type">dependent types</a> are useful for ensuring arbitrary shape safety (e.g., when concatenating and reshaping matrices), they are unnecessary for simple equality checking (such as when multiplying two matrices). When the shape of a tensor is known at compile-time, it is possible to encode this information using a less powerful type system*, as long as it supports subtyping and parametric polymorphism (a.k.a. generics). In practice, we can implement a shape-checked tensor arithmetic in languages like Java, Kotlin, C++, C# or Typescript, which accept generic type parameters. In Kotlin, whose type system is <a href="https://kotlinlang.org/docs/reference/generics.html#variance">less expressive</a> than Java, we use the following strategy.</p>
<p>Shape safety is currently supported up to rank-2 tensors, i.e. matrices. To perform dimension checking in our type system, we first enumerate a list of integer type literals as a chain of subtypes, <code>C &lt;: C - 1 &lt;: C - 2 &lt;: ... &lt;: 1 &lt;: 0</code>, where <code>C</code> is the largest fixed-length dimension we wish to represent, which can be specified by the user prior to compilation. This guarantees linear space and time complexity for subtype checking, with a constant upper bound.</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span>
<span class="normal"><a href="#__codelineno-24-6">6</a></span>
<span class="normal"><a href="#__codelineno-24-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="nd">@file</span><span class="p">:</span><span class="n">Suppress</span><span class="p">(</span><span class="s">&quot;ClassName&quot;</span><span class="p">)</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="kd">interface</span><span class="w"> </span><span class="nc">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="n">D0</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">i</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Used for certain type bounds</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">D0</span><span class="p">(</span><span class="kd">open</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">i</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">:</span><span class="w"> </span><span class="n">D0</span><span class="p">(),</span><span class="w"> </span><span class="n">Nat</span><span class="o">&lt;</span><span class="n">D0</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">D1</span><span class="p">(</span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">i</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">):</span><span class="w"> </span><span class="n">D0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="p">(),</span><span class="w"> </span><span class="n">Nat</span><span class="o">&lt;</span><span class="n">D1</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">D2</span><span class="p">(</span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">i</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">):</span><span class="w"> </span><span class="n">D1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">:</span><span class="w"> </span><span class="n">D2</span><span class="p">(),</span><span class="w"> </span><span class="n">Nat</span><span class="o">&lt;</span><span class="n">D2</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">D3</span><span class="p">(</span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">i</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">):</span><span class="w"> </span><span class="n">D2</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">:</span><span class="w"> </span><span class="n">D3</span><span class="p">(),</span><span class="w"> </span><span class="n">Nat</span><span class="o">&lt;</span><span class="n">D3</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="c1">//... † Automatically generated</span>
</code></pre></div></td></tr></table></div>
<p>Next, we overload the call operator to emulate instantiating a collection literal, using arity to infer its dimensionality. Consider the rank-1 case for length inference on vector literals:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span>
<span class="normal"><a href="#__codelineno-25-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="kd">open</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Vec</span><span class="o">&lt;</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">Len</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="o">&gt;</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">contents</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span><span class="p">)</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Vec</span><span class="p">(</span><span class="n">t1</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D1</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="n">t1</span><span class="p">))</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Vec</span><span class="p">(</span><span class="n">t1</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">))</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Vec</span><span class="p">(</span><span class="n">t1</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">t3</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D3</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">,</span><span class="w"> </span><span class="n">t3</span><span class="p">))</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="c1">//... † Automatically generated</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we encode length as a parameter of the operand type. Since integer literals are a chain of subtypes, we need only define one operator using the highest literal, and can rely on <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution</a> to preserve shape safety for all subtypes.</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="kd">infix</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">C</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">:</span><span class="w"> </span><span class="n">Vec</span><span class="err">&lt;</span><span class="n">Int</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="o">&gt;</span><span class="err">&gt; </span><span class="n">V</span><span class="p">.</span><span class="nf">plus</span><span class="p">(</span><span class="n">v</span><span class="p">:</span><span class="w"> </span><span class="n">V</span><span class="p">):</span><span class="w"> </span><span class="n">Vec</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="w">  </span><span class="n">Vec</span><span class="p">(</span><span class="n">contents</span><span class="p">.</span><span class="na">zip</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="na">contents</span><span class="p">).</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>The operator <code>+</code> can now be used like so. Incompatible operands will cause a type error:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">          </span><span class="c1">// Always runs safely</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="cm">/*...*/</span><span class="p">))</span><span class="w">  </span><span class="c1">// May fail at runtime</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="kd">val</span><span class="w"> </span><span class="nv">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">add</span><span class="w">                      </span><span class="c1">// Does not compile</span>
</code></pre></div></td></tr></table></div>
<p>A similar syntax is available for <a href="core/src/commonMain/kotlin/ai/hypergraph/kotlingrad/api/Matrix.kt">matrices</a> and higher-rank <a href="core/src/commonMain/kotlin/ai/hypergraph/kotlingrad/api/Tensor.kt">tensors</a>. For example, Kotlin∇ can infer the shape of multiplying two matrices, and will not compile if their inner dimensions do not match:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="kd">open</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Mat</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="o">&gt;</span><span class="p">(</span><span class="k">vararg</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">rows</span><span class="p">:</span><span class="w"> </span><span class="n">Vec</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="o">&gt;</span><span class="p">)</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Mat1x2</span><span class="p">(</span><span class="n">d0</span><span class="p">:</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">d1</span><span class="p">:</span><span class="w"> </span><span class="n">X</span><span class="p">):</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">D1</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat</span><span class="p">(</span><span class="n">Vec</span><span class="p">(</span><span class="n">d0</span><span class="p">,</span><span class="w"> </span><span class="n">d1</span><span class="p">))</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Mat2x1</span><span class="p">(</span><span class="n">d0</span><span class="p">:</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">d1</span><span class="p">:</span><span class="w"> </span><span class="n">X</span><span class="p">):</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="p">,</span><span class="w"> </span><span class="n">D1</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat</span><span class="p">(</span><span class="n">Vec</span><span class="p">(</span><span class="n">d0</span><span class="p">),</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">d1</span><span class="p">))</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="c1">//... † Automatically generated</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Q</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">:</span><span class="w"> </span><span class="n">D1</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Mat</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="o">&gt;</span><span class="p">.</span><span class="na">times</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TODO</span><span class="p">()</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="c1">// Inferred type: Mat&lt;Int, D4, D4&gt;</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="kd">val</span><span class="w"> </span><span class="nv">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat4x4</span><span class="p">(</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">  </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="w">  </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">  </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">  </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="p">)</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="c1">// Inferred type: Mat&lt;Int, D4, D3&gt;</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a><span class="kd">val</span><span class="w"> </span><span class="nv">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mat4x3</span><span class="p">(</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a><span class="w">  </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="w">  </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a><span class="w">  </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="w">  </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a><span class="p">)</span>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a><span class="c1">// Inferred type: Mat&lt;Int, D4, D3&gt;</span>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a><span class="kd">val</span><span class="w"> </span><span class="nv">lm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span>
<a id="__codelineno-28-25" name="__codelineno-28-25"></a><span class="c1">// m * m // Compile error: Expected Mat&lt;3, *&gt;, found Mat&lt;4, 3&gt;</span>
</code></pre></div></td></tr></table></div>
<p><a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/MatrixDemo.kt">Further examples</a> are provided for shape-safe matrix operations such as addition, subtraction and transposition.</p>
<p>A similar technique is possible in Haskell, which is capable of a more powerful form of type-level computation, <a href="https://wiki.haskell.org/Type_arithmetic">type arithmetic</a>. Type arithmetic makes it easy to express <a href="https://arxiv.org/pdf/1603.07285.pdf">convolutional arithmetic</a> and other arithmetic operations on shape variables (say, splitting a vector in half), which is currently not possible, or would require enumerating every possible combination of type literals.</p>
<p><sup>&lowast;</sup> Many type systems are still capable of performing arbitrary computation in the type checker. As specified, Java's type system is <a href="https://arxiv.org/pdf/1605.05274.pdf">known to be Turing Complete</a>. It may be possible to emulate a limited form of dependent types in Java by exploiting this property, although this may not be computationally tractable due to the practical limitations noted by Grigore.</p>
<p><sup>&dagger;</sup> Statically generated code, shipped within the library. To regenerate these methods (e.g., using larger dimensions), a code generator is <a href="shipshape/src/main/kotlin/ai/hypergraph/shipshape">provided</a>.</p>
<h4 id="intermediate-representation">Intermediate representation</h4>
<p>Kotlin∇ programs are <a href="#multi-stage-programming">staged</a> into <a href="https://github.com/breandan/kaliningraph">Kaliningraph</a>, an experimental IR for graph computation. As written by the user, many graphs are computationally suboptimal due to expression swell and parameter sharing. To accelerate forward- and backpropagation, it is often advantageous to simplify the graph by applying the <a href="https://github.com/breandan/kotlingrad/blob/master/specification.md#operational-semantics">reduction semantics</a> in a process known as <a href="https://en.wikipedia.org/wiki/Graph_canonization">graph canonicalization</a>. Kaliningraph enables compiler-like optimizations over the graph such as expression simplification and analytic root-finding, and supports features for visualization and debugging, e.g., in <a href="https://github.com/breandan/kotlingrad/blob/master/samples/notebooks/hello_kotlingrad.ipynb">computational notebooks</a>.</p>
<h4 id="property-delegation">Property delegation</h4>
<p><a href="https://kotlinlang.org/docs/reference/delegated-properties.html">Property delegation</a> is a reflection feature in the Kotlin language which lets us access properties to which an instance is bound. For example, we can read the property name like so:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span>
<span class="normal"><a href="#__codelineno-29-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Var</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="w">  </span><span class="kd">operator</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getValue</span><span class="p">(</span><span class="n">thisRef</span><span class="p">:</span><span class="w"> </span><span class="kt">Any?</span><span class="p">,</span><span class="w"> </span><span class="n">property</span><span class="p">:</span><span class="w"> </span><span class="n">KProperty</span><span class="o">&lt;*&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Var</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">property</span><span class="p">.</span><span class="na">name</span><span class="p">)</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This feature allows consumers to instantiate variables e.g., in an embedded DSL without redeclaring their names:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Var</span><span class="p">()</span><span class="w">   </span><span class="c1">// With property delegation</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Var</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Without property delegation</span>
</code></pre></div></td></tr></table></div>
<p>Without property delegation, users would need to repeat the property name in the constructor.</p>
<h2 id="experimental-ideas">Experimental ideas</h2>
<p>The current API is stable but can be <a href="https://github.com/breandan/kotlingrad/issues">improved</a> in many ways. Currently, Kotlin∇ does not infer a function's input dimensionality (i.e. free variables and their corresponding shape). While it is possible to perform <a href="#variable-capture">variable capture</a> over a small alphabet using <a href="samples/src/main/kotlin/ai/hypergraph/kotlingrad/samples/VariableCapture.kt">type safe currying</a>, this technique incurs a large source code <a href="core/src/commonMain/kotlin/ai/hypergraph/kotlingrad/typelevel/VariableCapture.kt">overhead</a>. It may be possible to reduce the footprint using <a href="https://gist.github.com/breandan/d0d7c21bb7f78ef54c21ce6a6ac49b68">phantom types</a> or some form of union type bound (cf. <a href="https://kotlinlang.org/docs/reference/generics.html#upper-bounds">Kotlin</a>, <a href="https://docs.oracle.com/javase/tutorial/java/generics/bounded.html">Java</a>).</p>
<p>When the shape of an N-dimensional array is known at compile-time, we can use <a href="shipshape/src/main/kotlin/ai/hypergraph/shipshape/DimGen.kt">type-level integers</a> to ensure shape conforming tensor operations (inspired by <a href="https://github.com/ctongfei/nexus">Nexus</a> and others).</p>
<p>Allowing users to specify a matrix's structure in its type signature, (e.g., <code>Singular</code>, <code>Symmetric</code>, <code>Orthogonal</code>, <code>Unitary</code>, <code>Hermitian</code>, <code>Toeplitz</code>) would allow us to specialize derivation over such matrices (cf. <a href="https://www.math.uwaterloo.ca/~hwolkowi/matrixcookbook.pdf#page=14">section 2.8</a> of The Matrix Cookbook).</p>
<h3 id="church-encoding">Church encoding</h3>
<p>Computers appear to be very complicated machines. Beneath this complexity lies a remarkably simple idea: many apparently complex routines can be rewritten in terms of function composition. Consider the binary operator <code>^</code>, which can be lowered as follows:</p>
<p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a>a ^ b :=  a * ... * a 
<a id="__codelineno-31-2" name="__codelineno-31-2"></a>          \_________/
<a id="__codelineno-31-3" name="__codelineno-31-3"></a>            b times
<a id="__codelineno-31-4" name="__codelineno-31-4"></a>a * b :=  a + ... + a 
<a id="__codelineno-31-5" name="__codelineno-31-5"></a>          \_________/
<a id="__codelineno-31-6" name="__codelineno-31-6"></a>            b times
<a id="__codelineno-31-7" name="__codelineno-31-7"></a>a + b :=  a + 1 + ... + 1
<a id="__codelineno-31-8" name="__codelineno-31-8"></a>              \_________/
<a id="__codelineno-31-9" name="__codelineno-31-9"></a>                b times
<a id="__codelineno-31-10" name="__codelineno-31-10"></a>a := next*(next(...next(1)...))
<a id="__codelineno-31-11" name="__codelineno-31-11"></a>     \________________/
<a id="__codelineno-31-12" name="__codelineno-31-12"></a>          a times
</code></pre></div></td></tr></table></div>
&lowast; <code>next</code> is also called <code>S</code> in <a href="https://en.wikipedia.org/wiki/Successor_function">Peano arithmetic</a>.</p>
<p>By using the λ-calculus, Church <a href="https://compcalc.github.io/public/church/church_calculi_1941.pdf#page=9">tells us</a>, we can lower a large portion of mathematics onto a single operator: function application. Curry, by way of <a href="https://writings.stephenwolfram.com/data/uploads/2020/12/Schonfinkel-OnTheBuildingBlocksOfMathematicalLogic.pdf">Schönfinkel</a>, gives us combinatory logic, a kind of Rosetta stone for deciphering and translating between a host of cryptic languages. These two ideas, λ-calculus and combinators, are keys to unlocking many puzzles in computer science and mathematics.</p>
<p>Though mathematically elegant, Church numerals are not particularly efficient or pleasant to read. One discovers that trying to encode Church arithmetic in a language without dependent types grows quickly impractical. By selecting a higher radix, however, it is possible to reduce spatial complexity and improve readability, albeit at the cost of increased temporal complexity on certain operations (e.g., <code>+</code> and <code>-</code>). Kotlin∇ uses a <a href="#type-arithmetic">binary encoding</a> by default, however generators for other bases are also provided for convenience.</p>
<h3 id="type-classes">Type classes</h3>
<p>The trouble with numerical towers is that they assume all inheritors are aware of the tower. In practice, many types we would like to reuse are entirely oblivious to our DSL. How do we allow users to bring in existing types without needing to modify their source code? This kind of <a href="https://en.wikipedia.org/wiki/Ad_hoc_polymorphism">ad hoc polymorphism</a> can be achieved using a pattern called the <a href="https://en.wikipedia.org/wiki/Type_class">type class</a>. While the JVM does not allow multiple inheritance on classes, it does support multiple inheritance and <a href="https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html">default methods</a> on interfaces, allowing users to implement an interface via delegation rather than inheritance.</p>
<p>Suppose we have a base type, <code>Nat</code> defined as an interface with a unitary member, <code>nil</code>, and its successor function, <code>next</code>, representing the <a href="https://en.wikipedia.org/wiki/Church_axioms">Church encoding</a> for natural numbers. To emulate instantiation, we can provide a <a href="https://kotlinlang.org/docs/nested-classes.html">nested class</a> equipped with a constructor overriding <code>nil</code> and <code>next</code> as follows:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nc">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="nv">nil</span><span class="p">:</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="nv">one</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">get</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="p">.</span><span class="na">next</span><span class="p">()</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="w">  </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">next</span><span class="p">():</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="w">  </span><span class="kd">class</span><span class="w"> </span><span class="nc">of</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">nil</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">vnext</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">.()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="w">  </span><span class="p">):</span><span class="w"> </span><span class="n">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">next</span><span class="p">():</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vnext</span><span class="p">()</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, if we wanted to wrap an external type, such as <code>Double</code>, inside our tower, we could do so as follows:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">doubleNat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nat</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">nil</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Although the <code>Nat</code> interface is very expressive, evaluating arithmetic expressions on <code>Nat</code>s can be computationally expensive. For instance, we could define the first three <a href="https://en.wikipedia.org/wiki/Hyperoperation">hyperoperations</a> naïvely as follows:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span>
<span class="normal"><a href="#__codelineno-34-3">3</a></span>
<span class="normal"><a href="#__codelineno-34-4">4</a></span>
<span class="normal"><a href="#__codelineno-34-5">5</a></span>
<span class="normal"><a href="#__codelineno-34-6">6</a></span>
<span class="normal"><a href="#__codelineno-34-7">7</a></span>
<span class="normal"><a href="#__codelineno-34-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="kd">tailrec</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="na">plus</span><span class="p">(</span><span class="n">l</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="p">):</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">plus</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="p">.</span><span class="na">next</span><span class="p">(),</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="na">next</span><span class="p">())</span>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="kd">tailrec</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="na">times</span><span class="p">(</span><span class="n">l</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="p">):</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">times</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="na">next</span><span class="p">())</span>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="kd">tailrec</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="na">pow</span><span class="p">(</span><span class="n">base</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">exp</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="p">):</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">exp</span><span class="p">)</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="n">exp</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="na">next</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>However, we note that computing <code>pow(a, b)</code> using this representation requires 𝓞(a↑b) operations using <a href="https://en.wikipedia.org/wiki/Knuth%27s_up-arrow_notation">Knuth notation</a>. Clearly, we must do better if this encoding is to be usable. We can make <code>Nat</code> more efficient by introducing a subtype, <code>Group</code>, which forces implementors to define a native addition operator:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nc">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="w">  </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">next</span><span class="p">():</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">one</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="w">  </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">plus</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="w">  </span><span class="kd">class</span><span class="w"> </span><span class="nc">of</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">nil</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">one</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">plus</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="w">  </span><span class="p">):</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">plus</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plus</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Given a <code>Group</code>, we can now define a more efficient implementation of Fibonacci. This will use the group-specific addition operator:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-36-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-36-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-36-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-36-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-36-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-36-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-36-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-36-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-36-10">10</a></span>
<span class="normal"><a href="#__codelineno-36-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="kd">tailrec</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">Nat</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="na">fibonacci</span><span class="p">(</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="w">  </span><span class="n">n</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="w">  </span><span class="n">seed</span><span class="p">:</span><span class="w"> </span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="p">,</span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="w">  </span><span class="n">fib</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a><span class="w">  </span><span class="n">i</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="p">,</span>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="p">):</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">seed</span><span class="p">).</span><span class="na">first</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a><span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">seed</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="na">next</span><span class="p">())</span>
<a id="__codelineno-36-9" name="__codelineno-36-9"></a>
<a id="__codelineno-36-10" name="__codelineno-36-10"></a><span class="kd">val</span><span class="w"> </span><span class="nv">doubleGroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Group</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">plus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-36-11" name="__codelineno-36-11"></a><span class="n">println</span><span class="p">(</span><span class="n">doubleGroup</span><span class="p">.</span><span class="na">fibonacci</span><span class="p">(</span><span class="m">10.0</span><span class="p">))</span><span class="w"> </span><span class="c1">// Prints: 233.0</span>
</code></pre></div></td></tr></table></div>
<p>We could further extend this chain by introducing a subtype called <code>Ring</code>, which overrides <code>+</code> and requires implementors to define a native <code>*</code> operator. <code>Ring</code>s and their relatives are known to have many useful applications in <a href="https://github.com/breandan/kaliningraph#algebra">graph theory</a> and <a href="https://github.com/breandan/markovian#algebraic-methods">statistics</a>:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-37-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-37-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-37-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-37-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-37-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-37-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-37-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-37-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-37-10">10</a></span>
<span class="normal"><a href="#__codelineno-37-11">11</a></span>
<span class="normal"><a href="#__codelineno-37-12">12</a></span>
<span class="normal"><a href="#__codelineno-37-13">13</a></span>
<span class="normal"><a href="#__codelineno-37-14">14</a></span>
<span class="normal"><a href="#__codelineno-37-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="kd">interface</span><span class="w"> </span><span class="nc">Ring</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">:</span><span class="w"> </span><span class="n">Group</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="w">  </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">plus</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="w">  </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">):</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="w">  </span><span class="kd">class</span><span class="w"> </span><span class="nc">of</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">nil</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kd">override</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">one</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">,</span>
<a id="__codelineno-37-7" name="__codelineno-37-7"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">plus</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="p">,</span>
<a id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">times</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span>
<a id="__codelineno-37-9" name="__codelineno-37-9"></a><span class="w">  </span><span class="p">):</span><span class="w"> </span><span class="n">Ring</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-37-10" name="__codelineno-37-10"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">plus</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plus</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-37-11" name="__codelineno-37-11"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-37-12" name="__codelineno-37-12"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-37-13" name="__codelineno-37-13"></a><span class="p">}</span>
<a id="__codelineno-37-14" name="__codelineno-37-14"></a>
<a id="__codelineno-37-15" name="__codelineno-37-15"></a><span class="kd">val</span><span class="w"> </span><span class="nv">doubleRing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ring</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">plus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>Since differentiation is a <a href="https://en.wikipedia.org/wiki/Linear_map">linear map</a> between function spaces, we now have the primitives necessary to build a fully-generic AD system, and could easily implement the <a href="https://compcalc.github.io/public/pytorch/ad_pytorch.pdf#page=6">sum and product rules</a>. To view the above example in full, see <a href="https://github.com/breandan/kaliningraph/blob/master/src/commonMain/kotlin/ai/hypergraph/kaliningraph/types/Types.kt"><code>Types.kt</code></a>.</p>
<p>What benefit does this abstraction provide to the end user? By parameterizing over primitive operators, Kotlin∇ consumers can easily swap out a tensor backend without needing to alter or recompile any upstream dependencies. This feature makes multiplatform development a breeze: wherever a type class operator (e.g., <code>+</code> or <code>*</code>) with matching signature is encountered across a project, it will be dispatched to the user-supplied lambda delegate for specialized execution on custom hardware. Runtime indirection can be elided with proper compiler inlining for zero-cost abstraction.</p>
<h3 id="type-arithmetic">Type arithmetic</h3>
<p>By default, Kotlin∇ supports compile time type arithmetic in the following domain:</p>
<ul>
<li>Fully symmetric arithmetic: <code>{ a ⍟ b ϵ [0..16){+,-,*}[0..16) | 0 ≤ a ⍟ b }</code></li>
<li>Asymmetric arithmetic: <code>{ a ⍟ b ϵ [0..512){+,-}[0..16) | 0 ≤ a ⍟ b &lt; 512 }</code></li>
<li>Semi-symmetric arithmetic: <code>{ a / b = c, a = b * c | a, b, c ϵ [0..128) &amp; a % b = 0 }</code></li>
</ul>
<p>Arithmetic outside this domain is checked at runtime, prior to evaluation.</p>
<p>Compile time type arithmetic is achieved by generating a type-level representation of the <a href="#church-encoding">Church encoding</a>. A usage example is shown in <a href="/core/src/commonTest/kotlin/ai/hypergraph/kotlingrad/typelevel/church/ChurchArithmeticTest.kt"><code>ChurchArithmeticTest.kt</code></a>, which may be run with the following command:</p>
<div class="language-sh highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a>./gradlew<span class="w"> </span>:kotlingrad:cleanJvmTest<span class="w"> </span>:kotlingrad:jvmTest<span class="w"> </span>--tests<span class="w"> </span><span class="s2">&quot;ai.hypergraph.kotlingrad.typelevel.church.ChurchArithmeticTest&quot;</span>
</code></pre></div></td></tr></table></div>
<p>Extensions to other bases, including <a href="/core/src/commonTest/kotlin/ai/hypergraph/kotlingrad/typelevel/binary/BinaryArithmeticTest.kt">binary</a> and <a href="/core/src/commonTest/kotlin/ai/hypergraph/kotlingrad/typelevel/chinese/AbacusTest.kt">decimal</a> are also provided, which may be used as follows:</p>
<div class="language-kotlin highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-39-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-39-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-39-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-39-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-39-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-39-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-39-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-39-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-39-10">10</a></span>
<span class="normal"><a href="#__codelineno-39-11">11</a></span>
<span class="normal"><a href="#__codelineno-39-12">12</a></span>
<span class="normal"><a href="#__codelineno-39-13">13</a></span>
<span class="normal"><a href="#__codelineno-39-14">14</a></span>
<span class="normal"><a href="#__codelineno-39-15">15</a></span>
<span class="normal"><a href="#__codelineno-39-16">16</a></span>
<span class="normal"><a href="#__codelineno-39-17">17</a></span>
<span class="normal"><a href="#__codelineno-39-18">18</a></span>
<span class="normal"><a href="#__codelineno-39-19">19</a></span>
<span class="normal"><a href="#__codelineno-39-20">20</a></span>
<span class="normal"><a href="#__codelineno-39-21">21</a></span>
<span class="normal"><a href="#__codelineno-39-22">22</a></span>
<span class="normal"><a href="#__codelineno-39-23">23</a></span>
<span class="normal"><a href="#__codelineno-39-24">24</a></span>
<span class="normal"><a href="#__codelineno-39-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="c1">// Boolean arithmetic</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">b32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="c1">// B_4&lt;Ø&gt;</span>
<a id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="p">.</span><span class="na">F</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// B_8&lt;Ø&gt;</span>
<a id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">T</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="c1">// T&lt;T&lt;F&lt;T&lt;Ø&gt;&gt;&gt;&gt;</span>
<a id="__codelineno-39-6" name="__codelineno-39-6"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="c1">// T&lt;F&lt;T&lt;T&lt;Ø&gt;&gt;&gt;&gt;</span>
<a id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="c1">// T&lt;T&lt;F&lt;T&lt;Ø&gt;&gt;&gt;&gt;</span>
<a id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="c1">// T&lt;F&lt;T&lt;T&lt;Ø&gt;&gt;&gt;&gt;</span>
<a id="__codelineno-39-9" name="__codelineno-39-9"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="c1">// T&lt;T&lt;T&lt;T&lt;Ø&gt;&gt;&gt;&gt;</span>
<a id="__codelineno-39-10" name="__codelineno-39-10"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">}</span><span class="w">     </span><span class="c1">// T&lt;F&lt;F&lt;F&lt;Ø&gt;&gt;&gt;&gt;</span>
<a id="__codelineno-39-11" name="__codelineno-39-11"></a>
<a id="__codelineno-39-12" name="__codelineno-39-12"></a><span class="n">assertEquals</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="na">F</span><span class="p">.</span><span class="na">F</span><span class="p">.</span><span class="na">F</span><span class="p">.</span><span class="na">F</span><span class="p">,</span><span class="w"> </span><span class="n">b32</span><span class="p">)</span>
<a id="__codelineno-39-13" name="__codelineno-39-13"></a>
<a id="__codelineno-39-14" name="__codelineno-39-14"></a><span class="c1">// Chinese arithmetic</span>
<a id="__codelineno-39-15" name="__codelineno-39-15"></a><span class="kd">val</span><span class="w"> </span><span class="err">四十二 = (十七 减 九)</span>
<a id="__codelineno-39-16" name="__codelineno-39-16"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span><span class="w">        </span><span class="c1">// 六&lt;一&lt;无&gt;&gt;</span>
<a id="__codelineno-39-17" name="__codelineno-39-17"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">八</span><span class="p">)</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">六</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// 零&lt;三&lt;无&gt;&gt;</span>
<a id="__codelineno-39-18" name="__codelineno-39-18"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="err">减</span><span class="w"> </span><span class="err">三</span><span class="p">)</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">九</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// 六&lt;三&lt;无&gt;&gt;</span>
<a id="__codelineno-39-19" name="__codelineno-39-19"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">六</span><span class="p">)</span><span class="w"> </span><span class="err">除</span><span class="w"> </span><span class="err">六</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// 七&lt;无&gt;</span>
<a id="__codelineno-39-20" name="__codelineno-39-20"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="err">乘</span><span class="w"> </span><span class="err">六</span><span class="p">)</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">五</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// 七&lt;四&lt;无&gt;&gt;</span>
<a id="__codelineno-39-21" name="__codelineno-39-21"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="err">减</span><span class="w"> </span><span class="err">三</span><span class="p">)</span><span class="w"> </span><span class="err">减</span><span class="w"> </span><span class="err">九</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// 五&lt;三&lt;无&gt;&gt;</span>
<a id="__codelineno-39-22" name="__codelineno-39-22"></a><span class="w">  </span><span class="p">.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">五</span><span class="p">)</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="err">二</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// 二&lt;四&lt;无&gt;&gt;</span>
<a id="__codelineno-39-23" name="__codelineno-39-23"></a><span class="w">  </span><span class="p">.</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">assertEquals</span><span class="p">(</span><span class="err">六</span><span class="w"> </span><span class="err">乘</span><span class="w"> </span><span class="err">七</span><span class="p">,</span><span class="w"> </span><span class="nb">it</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-39-24" name="__codelineno-39-24"></a>
<a id="__codelineno-39-25" name="__codelineno-39-25"></a><span class="n">assertEquals</span><span class="p">(</span><span class="m">42</span><span class="p">,</span><span class="w"> </span><span class="err">四十二</span><span class="p">.</span><span class="na">toInt</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>To alter the arithmetic domain, edit the file <a href="/shipshape/src/main/kotlin/ai/hypergraph/shipshape/BinGen.kt"><code>BinGen.kt</code></a>/<a href="/shipshape/src/main/kotlin/ai/hypergraph/shipshape/算盘厂.kt"><code>算盘厂.kt</code></a>, then use the following command to regenerate <a href="/core/src/commonMain/gen/ai/hypergraph/kotlingrad/typelevel/binary/Arithmetic.kt"><code>Arithmetic.kt</code></a>/<a href="/core/src/commonMain/gen/ai/hypergraph/kotlingrad/typelevel/chinese/算盘.kt"><code>算盘.kt</code></a>:</p>
<div class="language-sh highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a>./gradlew<span class="w"> </span>genShapes
</code></pre></div></td></tr></table></div>
<p>In practice, compile time type arithmetic may struggle to compute numbers in excess of <code>4095</code>. The Kotlin team has been informed of these issues:</p>
<ul>
<li><a href="https://youtrack.jetbrains.com/issue/KT-30040">KT-30040</a></li>
<li><a href="https://youtrack.jetbrains.com/issue/KT-50466"><del>KT-50466</del></a></li>
<li><a href="https://youtrack.jetbrains.com/issue/KT-50533">KT-50533</a></li>
<li><a href="https://youtrack.jetbrains.com/issue/KT-50553">KT-50553</a></li>
<li><a href="https://youtrack.jetbrains.com/issue/KT-50617"><del>KT-50617</del></a></li>
</ul>
<p>This API is experimental and subject to change without notice. In the future, it will be used to statically type check tensor functions whose output shape is an arithmetic function of the input shapes, e.g., concatenation, splitting and <a href="https://arxiv.org/pdf/1603.07285.pdf">convolution</a>.</p>
<h2 id="grammar">Grammar</h2>
<p>For a detailed grammar and semantics, please refer to <a href="specification.md">the Kotlin∇ specification</a>.</p>
<h2 id="uml-diagram">UML Diagram</h2>
<p>The following graph depicts the subtyping relation between classes and interfaces in Kotlin∇.</p>
<p><a href="https://raw.githubusercontent.com/breandan/kotlingrad/master/samples/src/main/resources/uml_diagram.svg"><img alt="" src="samples/src/main/resources/uml_diagram.svg" /></a></p>
<h2 id="comparison">Comparison</h2>
<p>Unlike certain frameworks which simply wrap an existing AD library in a type-safe DSL, Kotlin∇ contains a fully shape-safe implementation of algorithmic differentiation, written in pure Kotlin. By doing so, it can leverage Kotlin language features such as typed functional programming, as well as interoperability with other languages on the JVM platform. Furthermore, it implements <a href="http://breandan.net/public/masters_thesis.pdf#2a">symbolic differentiation</a>, which unlike Wengert tape or dual-number based ADs, allows it to calculate derivatives of arbitrarily high order with zero extra engineering required. Further details can be found below.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Framework</th>
<th style="text-align: center;">Language</th>
<th style="text-align: center;">SD¹</th>
<th style="text-align: center;">AD²</th>
<th style="text-align: center;">HD³</th>
<th style="text-align: center;">DP⁴</th>
<th style="text-align: center;">FP⁵</th>
<th style="text-align: center;">TS⁶</th>
<th style="text-align: center;">SS⁷</th>
<th style="text-align: center;">DT⁸</th>
<th style="text-align: center;">MP⁹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Kotlin∇</td>
<td style="text-align: center;">Kotlin</td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://diffsharp.github.io/DiffSharp/">DiffSharp</a></td>
<td style="text-align: center;">F#</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/fsprojects/TensorFlow.FSharp">TensorFlow.FSharp</a></td>
<td style="text-align: center;">F#</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/tribbloid/shapesafe">shapesafe</a></td>
<td style="text-align: center;">Scala</td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://tongfei.me/nexus/">Nexus</a></td>
<td style="text-align: center;">Scala</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://feiwang3311.github.io/Lantern/">Lantern</a></td>
<td style="text-align: center;">Scala</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/Hipparchus-Math/hipparchus">Hipparchus</a></td>
<td style="text-align: center;">Java</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/uniker9/JAutoDiff/">JAutoDiff</a></td>
<td style="text-align: center;">Java</td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://deeplearning4j.org/">Eclipse DL4J</a></td>
<td style="text-align: center;">Java</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/sicmutils/sicmutils">SICMUtils</a></td>
<td style="text-align: center;">Clojure</td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://halide-lang.org/">Halide</a></td>
<td style="text-align: center;">C++</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/leopiney/tensor-safe">Tensor Safe</a></td>
<td style="text-align: center;">Haskell</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/hasktorch/hasktorch">HaskTorch</a></td>
<td style="text-align: center;">Haskell</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/google-research/dex-lang">Dex</a></td>
<td style="text-align: center;">Haskell</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/HuwCampbell/grenade">Grenade</a></td>
<td style="text-align: center;">Haskell</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/Functional-AutoDiff/STALINGRAD">Stalin∇</a></td>
<td style="text-align: center;">Scheme</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/mila-udem/myia">Myia</a></td>
<td style="text-align: center;">Python</td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/HIPS/autograd/">Autograd</a></td>
<td style="text-align: center;">Python</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/google/jax">JAX</a></td>
<td style="text-align: center;">Python</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://github.com/google/tangent">Tangent</a></td>
<td style="text-align: center;">Python</td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://link.springer.com/content/pdf/10.1007/BF01070461.pdf#page=39">Analitik</a></td>
<td style="text-align: center;">Analitik</td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="✔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2714.svg" title=":heavy_check_mark:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
<td style="text-align: center;"><img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg" title=":x:" /></td>
</tr>
</tbody>
</table>
<p>¹ Symbolic differentiation<em>, ² Automatic differentiation</em>, ³ Higher-order/rank differentiation, ⁴ Differentiable programming*, ⁵ Functional programming, ⁶ Compile-time type safety, ⁷ Compile-time shape safety, ⁸ Dependently Typed, ⁹ Multiplatform</p>
<p><sup>&lowast;</sup> Although we do not distinguish between AD and SD, here we adopt the authors' preferred nomenclature. We do make a distinction between differentiable programming libraries and those which simply construct neural networks. The <img alt="🚧" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f6a7.svg" title=":construction:" /> symbol indicates work in progress.</p>
<h2 id="references">References</h2>
<p>To the author's knowledge, Kotlin∇ is the first AD implementation in native Kotlin. While the particular synthesis of these ideas (i.e. shape-safe, functional AD, using generic types) is unique, it has been influenced by a long list of prior work in AD. Below is a list of projects and publications that helped inspire this work.</p>
<h3 id="automatic-differentiation">Automatic differentiation</h3>
<ul>
<li><a href="http://conal.net/papers/essence-of-ad/essence-of-ad-icfp.pdf">The Simple Essence of Automatic Differentiation</a></li>
<li><a href="http://www-bcl.cs.may.ie/~barak/papers/toplas-reverse.pdf">Reverse-Mode AD in a Functional Framework: Lambda the Ultimate Backpropagator</a></li>
<li><a href="https://papers.nips.cc/paper/8092-automatic-differentiation-in-ml-where-we-are-and-where-we-should-be-going.pdf">Automatic differentiation in ML: Where we are and where we should be going</a></li>
<li><a href="https://uhra.herts.ac.uk/bitstream/handle/2299/8933/904722.pdf">A Leibniz Notation for Automatic Differentiation</a></li>
<li><a href="https://gist.github.com/rxwei/30ba75ce092ab3b0dce4bde1fc2c9f1d">First-Class Automatic Differentiation in Swift: A Manifesto</a></li>
<li><a href="https://colab.research.google.com/github/google/jax/blob/master/notebooks/autodiff_cookbook.ipynb">The (JAX) Autodiff Cookbook</a></li>
<li><a href="https://openreview.net/pdf?id=BJJsrmfCZ">Automatic Differentiation in PyTorch</a></li>
<li><a href="http://jmlr.org/papers/volume18/17-468/17-468.pdf">Automatic Differentiation in Machine Learning: a Survey</a></li>
<li><a href="https://doi.org/10.1007/978-3-642-57201-2_12">Complexity of Derivatives Generated by Symbolic Differentiation</a></li>
<li><a href="https://arxiv.org/pdf/1911.12604.pdf">Eigen-AD: Algorithmic Differentiation of the Eigen Library</a></li>
</ul>
<h3 id="complexity">Complexity</h3>
<ul>
<li><a href="http://www.cs.tau.ac.il/~amnon/Classes/2015-PRG/Papers/VSBR83.pdf">Fast parallel computation of polynomials using few processors</a>, Valiant and Skyum (1983)</li>
<li><a href="https://core.ac.uk/download/pdf/82480031.pdf">The complexity of partial derivatives</a>, Baur and Strassen (1983)</li>
<li><a href="https://www.math.ias.edu/~avi/PUBLICATIONS/MYPAPERS/NW96/final.pdf">Lower Bounds on Arithmetic Circuits via Partial Derivatives</a></li>
<li><a href="https://www.cs.tau.ac.il/~shpilka/publications/KlivansShpilka_Learning_via_partial_derivatives.pdf">Learning Restricted Models of Arithmetic Circuits</a></li>
</ul>
<h3 id="differentiable-programming">Differentiable programming</h3>
<ul>
<li><a href="https://colah.github.io/posts/2015-09-NN-Types-FP/">Neural Networks, Types, and Functional Programming</a></li>
<li><a href="https://papers.nips.cc/paper/8221-backpropagation-with-callbacks-foundations-for-efficient-and-expressive-differentiable-programming.pdf">Backpropagation with Continuation Callbacks: Foundations for Efficient and Expressive Differentiable Programming</a></li>
<li><a href="https://arxiv.org/pdf/1711.10455.pdf">Backprop as Functor: A compositional perspective on supervised learning</a></li>
<li><a href="https://www.cs.purdue.edu/homes/rompf/papers/wang-preprint201811.pdf">Demystifying Differentiable Programming: Shift/Reset the Penultimate Backpropagator</a></li>
<li><a href="https://arxiv.org/pdf/1806.02136.pdf">Efficient Differentiable Programming in a Functional Array-Processing Language</a></li>
<li><a href="https://arxiv.org/pdf/1610.07690.pdf">Operational Calculus for Differentiable Programming</a></li>
<li><a href="https://www.robots.ox.ac.uk/~gunes/assets/pdf/baydin-2016-slides-functionallondoners.pdf">Differentiable Functional Programming</a></li>
<li><a href="https://people.csail.mit.edu/tzumao/gradient_halide/gradient_halide.pdf">Differentiable Programming for Image Processing and Deep Learning in Halide</a></li>
<li><a href="https://medium.com/@karpathy/software-2-0-a64152b37c35">Software 2.0</a></li>
</ul>
<h3 id="calculus">Calculus</h3>
<ul>
<li><a href="https://explained.ai/matrix-calculus/index.html">The Matrix Calculus You Need For Deep Learning</a>, Parr and Howard (2018)</li>
<li><a href="https://arxiv.org/pdf/1707.02746.pdf">Backpropagation in matrix notation</a>, Mishachev (2017)</li>
<li><a href="https://www.math.uwaterloo.ca/~hwolkowi/matrixcookbook.pdf#derivatives">Matrix derivatives</a>, from the Matrix Cookbook</li>
<li><a href="https://archive.org/details/H.M.ScheyDivGradCurlAndAllThat">Div, Grad, Curl and All That</a>, Petersen and Pedersen (2012)</li>
<li><a href="https://atmos.washington.edu/~dennis/MatrixCalculus.pdf">Matrix Differentiation (and some other stuff)</a>, Barnes (2006)</li>
<li><a href="https://www.jstor.org/stable/2236019">Symbolic Matrix Derivatives</a>, Dwyer and Macphail (1948)</li>
</ul>
<h3 id="computer-algebra">Computer algebra</h3>
<ul>
<li><a href="https://doi.org/10.1145/3395658">Towards an API for the real numbers</a>, Boehm (2020)</li>
<li><a href="https://arxiv.org/pdf/2005.11644.pdf">miniKanren as a Tool for Symbolic Computation in Python</a>, Willard (2020)</li>
<li><a href="https://pdfs.semanticscholar.org/6fd2/88960ef83469c898a3d8ed8f0950e7839625.pdf">A Design Proposal for an Object Oriented Algebraic Library</a>, Niculescu (2003)</li>
<li><a href="https://www.cs.ubbcluj.ro/~studia-i/contents/2011-4/02-Niculescu.pdf">On Using Generics for Implementing Algebraic Structures</a>, Niculescu (2011)</li>
<li><a href="https://arxiv.org/pdf/0811.1061.pdf">How to turn a scripting language into a domain-specific language for computer algebra</a>, Jolly and Kredel (2008)</li>
<li><a href="https://pdfs.semanticscholar.org/ce81/39a9008bdc7d23be0ff05ef5a16d512b352c.pdf">Evaluation of a Java Computer Algebra System</a>, Kredel (2007)</li>
<li><a href="https://arxiv.org/pdf/1710.06892.pdf">Typesafe Abstractions for Tensor Operations</a>, Chen (2017)</li>
<li><a href="https://obilaniu6266h16.wordpress.com/2016/02/04/einstein-summation-in-numpy/">Einstein Summation in Numpy</a>, Bilaniuk (2016)</li>
<li><a href="https://www.cs.rit.edu/~anh/comp_alg.html">Issues in Computer Algebra</a>, Nunes-Harwitt</li>
<li><a href="https://www21.in.tum.de/~nipkow/TRaAT/">Term Rewriting and All That</a>, Baader and Nipkow (1998)</li>
<li><a href="http://users.utu.fi/aleokh/papers/conj_bool_programming.pdf">Describing the syntax of programming languages using conjunctive and Boolean grammars</a>, Okhotin (2016)</li>
<li><a href="https://users.math-cs.spbu.ru/~okhotin/papers/formal_languages_gf2.pdf">Formal languages over GF(2)</a>, Okhotin (2019)</li>
</ul>
<h3 id="symbolic-mathematics">Symbolic mathematics</h3>
<ul>
<li><a href="https://github.com/altavir/kmath">KMath</a> - Kotlin mathematics extensions library</li>
<li><a href="https://github.com/axkr/symja_android_library/">SymJa</a> - Computer algebra language &amp; symbolic math library for Android</li>
<li><a href="https://github.com/amodeus-science/tensor">tensor</a> - Linear algebra for tensors with symbolic and numeric scalars</li>
<li><a href="https://github.com/Hipparchus-Math/hipparchus">Hipparchus</a> - An efficient, general-purpose mathematics components library in the Java programming language</li>
<li><a href="http://minikanren.org/">miniKanren</a> - A tool for symbolic computation and logic programming</li>
<li><a href="https://github.com/yuemingl/SymJava">SymJava</a> - A Java library for fast symbolic-numeric computation</li>
<li><a href="https://github.com/kredel/java-algebra-system">JAS</a> - Java Algebra System</li>
<li><a href="https://github.com/mdgeorge4153/jalgebra">jalgebra</a> - An abstract algebra library for Java</li>
<li><a href="https://github.com/Cojac/Cojac">COJAC</a> - Numerical sniffing tool and Enriching number wrapper for Java</li>
<li><a href="https://www.chebfun.org">chebfun</a> - Allows representing functions as <a href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">Chebyshev polynomials</a>, for easy symbolic differentiation (or integration)</li>
<li><a href="https://github.com/horeilly1101/deriv">horeilly1101/deriv</a> - Open source derivative calculator REST API (and Java library)</li>
</ul>
<h3 id="neural-networks">Neural networks</h3>
<ul>
<li><a href="https://karpathy.github.io/neuralnets/">Hacker's Guide to Neural Networks</a>, Karpathy (2014)</li>
<li><a href="https://arxiv.org/pdf/1611.03777.pdf">Tricks from Deep Learning</a>, Baydin et al. (2016)</li>
<li><a href="https://blog.jle.im/entry/practical-dependent-types-in-haskell-1.html">Practical Dependent Types in Haskell: Type-Safe Neural Networks</a>, Le (2016)</li>
<li><a href="https://arxiv.org/pdf/1603.07285.pdf">A guide to convolutional arithmetic for deep learning</a>, Dumoulin and Visin (2018)</li>
</ul>
<h3 id="type-systems">Type systems</h3>
<ul>
<li><a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/gadtoop.pdf">Generalized Algebraic Data Types and Object-Oriented Programming</a>, Kennedy and Russo (2005)</li>
<li><a href="https://arxiv.org/pdf/1605.05274.pdf">Java Generics are Turing Complete</a>, Grigore (2016)</li>
<li><a href="https://link.springer.com/content/pdf/10.1007%2F3-540-57880-3_23.pdf">Dimension Types</a>, Kennedy (2004)</li>
<li><a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-391.pdf#page=145">An algebraic view of dimension types</a>, Kennedy (1996)</li>
<li><a href="https://www.cs.cornell.edu/courses/cs3110/2011sp/Lectures/lec26-type-inference/type-inference.htm">Type Inference and Unification</a></li>
<li><a href="https://royalsocietypublishing.org/doi/pdf/10.1098/rsta.1984.0073">Constructive mathematics and computer programming</a>, Martin-Lof (1984)</li>
<li><a href="http://www.cse.chalmers.se/research/group/logic/book/book.pdf#page=23">Programming in Martin-Löf's Type Theory</a>, Nordstrom et al. (1990)</li>
</ul>
<h3 id="domain-specific-languages">Domain-specific languages</h3>
<ul>
<li><a href="http://conal.net/papers/jfp-saig/compile-dsel.pdf">Compiling Embedded Languages</a>, Elliott et al. (2003)</li>
<li><a href="https://static.csg.ci.i.u-tokyo.ac.jp/papers/14/scherr-ecoop2014.pdf">Implicit Staging of EDSL Expressions: A Bridge between Shallow and Deep Embedding</a>, Scherr and Chiba (2014)</li>
<li><a href="https://dl.acm.org/doi/pdf/10.1145/331963.331975">DSL Implementation Using Staging and Monads</a> Sheard et al. (1999)</li>
<li><a href="https://dl.acm.org/doi/pdf/10.1145/2972206.2972219">Deeply Reifying Running Code for Constructing a Domain-Specific Language</a>, Chiba et al. (2016)</li>
<li><a href="https://www.cs.purdue.edu/homes/rompf/papers/wei-oopsla19.pdf">Staged Abstract Interpreters</a>, Wei et al. (2019)</li>
<li><a href="https://static.csg.ci.i.u-tokyo.ac.jp/papers/19/nakamaru-jcl50.pdf">Generating Fluent Embedded Domain-Specific Languages with Subchaining</a>, Nakamaru et al. (2019)</li>
<li><a href="https://arxiv.org/pdf/2002.06179.pdf">Generating a Generic Fluent API in Java</a>, Nakamarua and Chiba (2020)</li>
<li><a href="https://drops.dagstuhl.de/opus/volltexte/2019/10805/pdf/LIPIcs-ECOOP-2019-13.pdf">Fling – A Fluent API Generator</a>, Gil and Roth (2019)</li>
<li><a href="https://ilyasergey.net/papers/groovy-dsl.pdf">Scripting an IDE for EDSL awareness</a>, Sergey et al. (2011)</li>
</ul>
<h3 id="automated-testing">Automated testing</h3>
<ul>
<li><a href="https://arxiv.org/pdf/1708.08559.pdf">DeepTest: Automated Testing of Deep-Neural-Network-driven Autonomous Cars</a>, Tian et al. (2018)</li>
<li><a href="https://www.eecs.northwestern.edu/~robby/courses/395-495-2009-fall/quick.pdf">QuickCheck: A Lightweight Tool for Random Testing of Haskell Programs</a>, Claessen and Hughes (2000)</li>
<li><a href="https://papers.nips.cc/paper/5350-learning-to-discover-efficient-mathematical-identities.pdf">Learning to Discover Efficient Mathematical Identities</a>, Zaremba et al. (2014)</li>
</ul>
<h3 id="ad-libraries">AD libraries</h3>
<ul>
<li><a href="https://github.com/fsprojects/TensorFlow.FSharp">TensorFlow.FSharp</a>: An eDSL for writing numerical models in F# with support for interactive tensor shape-checking</li>
<li><a href="https://github.com/Functional-AutoDiff/STALINGRAD">Stalin∇</a>, a brutally optimizing compiler for the VLAD language, a pure dialect of Scheme with first-class automatic differentiation operators</li>
<li><a href="https://github.com/hips/autograd">Autograd</a> - Efficiently computes derivatives of NumPy code</li>
<li><a href="https://github.com/mila-udem/myia">Myia</a> - SCT based AD, adapted from Pearlmutter &amp; Siskind's "Reverse Mode AD in a functional framework"</li>
<li><a href="https://github.com/google/jax">JAX</a> - Composable transformations of Python+NumPy programs: differentiate, vectorize, JIT to GPU/TPU, and more</li>
<li><a href="https://github.com/google-research/dex-lang">Dex</a> -  Research language for array processing in the Haskell/ML family</li>
<li><a href="https://github.com/ctongfei/nexus">Nexus</a> - Type-safe tensors, deep learning and probabilistic programming in Scala</li>
<li><a href="https://github.com/google/tangent">Tangent</a> - "Source-to-Source Debuggable Derivatives in Pure Python"</li>
<li><a href="https://github.com/HuwCampbell/grenade">Grenade</a> - composable, dependently typed, practical, and fast RNNs in Haskell</li>
<li><a href="https://feiwang3311.github.io/Lantern/">Lantern</a> - a framework in Scala, based on delimited continuations and multi-stage programming</li>
<li><a href="https://github.com/uniker9/JAutoDiff">JAutoDiff</a> - An Automatic Differentiation Library</li>
<li><a href="https://github.com/DiffSharp/DiffSharp">DiffSharp</a>, a functional AD library implemented in the F# language</li>
<li><a href="https://link.springer.com/content/pdf/10.1007/BF01070461.pdf">Analitik</a> - Algebraic language for the description of computing processes using analytical transformations</li>
</ul>
<h2 id="special-thanks">Special thanks</h2>
<p>The following individuals have helped shape this project through their enthusiasm and thoughtful feedback. Please check out their work.</p>
<ul>
<li><a href="http://liampaull.ca">Liam Paull</a></li>
<li><a href="https://michalis.famelis.info/">Michalis Famelis</a></li>
<li><a href="http://www.iro.umontreal.ca/~feeley/">Marc Feeley</a></li>
<li><a href="http://www-ens.iro.umontreal.ca/~syriani/">Eugene Syriani</a></li>
<li><a href="http://hannelita.com/">Hanneli Tavante</a></li>
<li><a href="https://www.iro.umontreal.ca/~monnier/">Stefan Monnier</a></li>
<li><a href="https://scholar.google.com/citations?user=B-WJi4kAAAAJ">Alexander Nozik</a></li>
<li><a href="https://twitter.com/headinthebox/">Erik Meijer</a></li>
<li><a href="https://krrish94.github.io/">Krishna Murthy</a></li>
<li><a href="https://pointersgonewild.com/">Maxime Chevalier-Boisvert</a></li>
<li><a href="https://scholar.google.com/citations?user=IcuGXgcAAAAJ&amp;hl=en">Kiran Gopinathan</a></li>
<li><a href="https://scholar.google.ca/citations?user=xG3VWpEAAAAJ">Jacob Miller</a></li>
<li><a href="http://www.adampocock.com/">Adam Pocock</a></li>
<li><a href="https://tscholak.github.io/">Torsten Scholak</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.tabs", "navigation.tracking", "search.suggest"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../javascript/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
        <script src="../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>